<!doctype html>
<html lang="en" dir="ltr" class="h-full">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <title>Hajzkoora</title>
    <script src="https://cdn.tailwindcss.com/3.4.17"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800;900&family=Outfit:wght@300;400;500;600;700;800&display=swap" rel="stylesheet"/>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              pitch: "#0D9B4A",
              pitchDark: "#087A3A",
              pitchLight: "#10B95C",
              sand: "#F5E6C8",
              sandDark: "#E8D4A8",
              midnight: "#0A1628",
              midnightLight: "#142240",
              accent: "#FF6B2C",
              accentDark: "#E55A1F",
            },
            fontFamily: {
              cairo: ["Cairo", "sans-serif"],
              outfit: ["Outfit", "sans-serif"],
            },
          },
        },
      };
    </script>
    <style>
      html, body { height: 100%; margin: 0; padding: 0; }
      body { font-family: "Outfit", sans-serif; box-sizing: border-box; }
      [dir="rtl"] body, [dir="rtl"] * { font-family: "Cairo", sans-serif; }
      ::-webkit-scrollbar { width: 6px; }
      ::-webkit-scrollbar-track { background: #0a1628; }
      ::-webkit-scrollbar-thumb { background: #0d9b4a; border-radius: 3px; }
      @keyframes fadeInUp { from { opacity:0; transform:translateY(24px); } to { opacity:1; transform:translateY(0); } }
      @keyframes fadeIn { from { opacity:0; } to { opacity:1; } }
      @keyframes slideDown { from { opacity:0; transform:translateY(-12px); } to { opacity:1; transform:translateY(0); } }
      @keyframes pulse-glow { 0%,100% { box-shadow:0 0 20px rgba(13,155,74,0.3); } 50% { box-shadow:0 0 40px rgba(13,155,74,0.6); } }
      @keyframes bounceIn { 0% { transform:scale(0.3); opacity:0; } 50% { transform:scale(1.05); } 70% { transform:scale(0.9); } 100% { transform:scale(1); opacity:1; } }
      @keyframes toastIn { from { transform:translateX(120%); opacity:0; } to { transform:translateX(0); opacity:1; } }
      @keyframes toastOut { from { transform:translateX(0); opacity:1; } to { transform:translateX(120%); opacity:0; } }
      @keyframes spin { to { transform:rotate(360deg); } }
      .anim-fade-up { animation:fadeInUp 0.6s ease-out forwards; }
      .anim-fade { animation:fadeIn 0.4s ease-out forwards; }
      .anim-slide-down { animation:slideDown 0.4s ease-out forwards; }
      .anim-bounce { animation:bounceIn 0.5s ease-out forwards; }
      .anim-spin { animation:spin 1s linear infinite; }
      .field-card { transition:all 0.3s cubic-bezier(0.4,0,0.2,1); }
      .field-card:hover { transform:translateY(-6px); box-shadow:0 20px 40px rgba(13,155,74,0.2); }
      .btn-primary { background:linear-gradient(135deg,#0d9b4a 0%,#087a3a 100%); transition:all 0.3s ease; }
      .btn-primary:hover { background:linear-gradient(135deg,#10b95c 0%,#0d9b4a 100%); transform:translateY(-1px); box-shadow:0 6px 20px rgba(13,155,74,0.4); }
      .btn-accent { background:linear-gradient(135deg,#ff6b2c 0%,#e55a1f 100%); transition:all 0.3s ease; }
      .btn-accent:hover { background:linear-gradient(135deg,#ff8a55 0%,#ff6b2c 100%); transform:translateY(-1px); }
      .glass-card { background:rgba(20,34,64,0.6); backdrop-filter:blur(12px); border:1px solid rgba(13,155,74,0.15); }
      .hero-bg {
        background:linear-gradient(135deg,rgba(10,22,40,0.8) 0%,rgba(20,34,64,0.85) 50%,rgba(10,22,40,0.9) 100%),
          url("https://media-cldnry.s-nbcnews.com/image/upload/t_fit-760w,f_auto,q_auto:best/newscms/2018_21/2444601/180525-mohamed-salah-liverpool-mn-0815.jpg") center right / cover no-repeat;
        position:relative; overflow:hidden;
      }
      .hero-bg::before {
        content:""; position:absolute; inset:0;
        background:radial-gradient(ellipse at 30% 50%,rgba(13,155,74,0.15) 0%,transparent 60%),
          radial-gradient(ellipse at 70% 80%,rgba(255,107,44,0.08) 0%,transparent 50%);
      }
      .toast-enter { animation:toastIn 0.4s ease-out forwards; }
      .toast-exit { animation:toastOut 0.3s ease-in forwards; }
      .slot-btn { transition:all 0.2s ease; }
      .slot-btn:hover:not(:disabled) { background:rgba(13,155,74,0.2); border-color:#0d9b4a; }
      .slot-btn.selected { background:#0d9b4a !important; color:white !important; border-color:#0d9b4a !important; }
      .slot-btn:disabled { opacity:0.3; cursor:not-allowed; }
      .input-field { background:rgba(20,34,64,0.8); border:1px solid rgba(13,155,74,0.2); color:#f5e6c8; transition:all 0.3s ease; }
      .input-field:focus { border-color:#0d9b4a; box-shadow:0 0 0 3px rgba(13,155,74,0.15); outline:none; }
      .input-field::placeholder { color:rgba(245,230,200,0.4); }
      select.input-field option { background:#142240; color:#f5e6c8; }
      .badge { display:inline-flex; align-items:center; padding:2px 10px; border-radius:9999px; font-size:0.75rem; font-weight:600; }
      .tab-btn { transition:all 0.3s ease; position:relative; }
      .tab-btn.active { color:#0d9b4a; }
      .tab-btn.active::after { content:""; position:absolute; bottom:-2px; left:0; right:0; height:2px; background:#0d9b4a; border-radius:1px; }
      .overlay { background:rgba(10,22,40,0.8); backdrop-filter:blur(4px); }
      .stat-card { background:linear-gradient(135deg,rgba(20,34,64,0.8) 0%,rgba(20,34,64,0.4) 100%); border:1px solid rgba(13,155,74,0.1); }
      .qr-module { fill:#0d9b4a; }
      .qr-bg { fill:#0a1628; }
      .field-image-container { position:relative; overflow:hidden; border-radius:0.5rem; height:160px; background:linear-gradient(135deg,rgba(13,155,74,0.1),rgba(255,107,44,0.1)); }
      .field-image-container img { width:100%; height:100%; object-fit:cover; }
      .field-image-container .image-overlay { position:absolute; top:0; left:0; right:0; bottom:0; background:linear-gradient(to bottom,transparent 50%,rgba(0,0,0,0.4)); }
    </style>
  </head>
  <body class="h-full bg-midnight text-sand overflow-auto">
    <div id="app" class="w-full h-full flex flex-col">
      <div id="toast-container" class="fixed top-4 right-4 z-[9999] flex flex-col gap-2" style="max-width:380px"></div>
      <div id="loading-overlay" class="fixed inset-0 z-[9998] flex items-center justify-center overlay hidden">
        <div class="flex flex-col items-center gap-4">
          <div class="w-12 h-12 border-4 border-pitch border-t-transparent rounded-full anim-spin"></div>
          <span class="text-sand text-sm font-medium">Loading...</span>
        </div>
      </div>
      <header id="app-header" class="sticky top-0 z-50 w-full" style="background:linear-gradient(90deg,#0a1628 0%,#142240 50%,#0a1628 100%);border-bottom:1px solid rgba(13,155,74,0.2);">
        <div class="max-w-7xl mx-auto px-4 py-3 flex items-center justify-between">
          <div class="flex items-center gap-3 cursor-pointer" onclick="navigate('home')">
            <svg width="36" height="36" viewBox="0 0 36 36" fill="none">
              <circle cx="18" cy="18" r="17" stroke="#0D9B4A" stroke-width="2"/>
              <circle cx="18" cy="18" r="6" stroke="#0D9B4A" stroke-width="1.5" fill="none"/>
              <line x1="18" y1="1" x2="18" y2="35" stroke="#0D9B4A" stroke-width="1" opacity="0.4"/>
              <path d="M1 18 Q9 10 18 10 Q27 10 35 18" stroke="#0D9B4A" stroke-width="1" fill="none" opacity="0.4"/>
              <path d="M1 18 Q9 26 18 26 Q27 26 35 18" stroke="#0D9B4A" stroke-width="1" fill="none" opacity="0.4"/>
            </svg>
            <span id="header-title" class="text-xl font-bold text-white tracking-tight font-outfit">Hajzkoora</span>
          </div>
          <nav class="flex items-center gap-2 sm:gap-4">
            <select id="lang-selector" onchange="changeLanguage(this.value)" class="bg-transparent border border-pitch/30 rounded-lg px-2 py-1 text-xs text-sand focus:outline-none focus:border-pitch">
              <option value="en">EN</option>
              <option value="ar">عربي</option>
              <option value="ur">اردو</option>
            </select>
            <div id="nav-links" class="flex items-center gap-2 sm:gap-3"></div>
          </nav>
        </div>
      </header>
      <main id="main-content" class="flex-1 w-full overflow-auto"></main>
    </div>

    <script>
    // ==========================================
    // PHOTO CACHE & RETRIEVAL SYSTEM
    // ==========================================

    // Unsplash Source (no key needed, stable random image per query)
    // Wikimedia Commons direct thumbnails for generic stadium/football images
    // We use a deterministic mapping to stable image sources

    const PHOTO_SOURCES = {
      // Generic football/pitch images by emirate from Wikimedia Commons or Unsplash Source
      'Abu Dhabi': [
        'https://upload.wikimedia.org/wikipedia/commons/thumb/f/f3/Zayed_Sports_City_Stadium.jpg/640px-Zayed_Sports_City_Stadium.jpg',
        'https://upload.wikimedia.org/wikipedia/commons/thumb/8/8b/Al-Nahyan_Stadium.jpg/640px-Al-Nahyan_Stadium.jpg',
        'https://upload.wikimedia.org/wikipedia/commons/thumb/3/3e/Mohammed_bin_Zayed_Stadium.jpg/640px-Mohammed_bin_Zayed_Stadium.jpg',
        'https://images.unsplash.com/photo-1529900748604-07564a03e7a6?w=640&q=80',
        'https://images.unsplash.com/photo-1522778119026-d647f0596c20?w=640&q=80',
        'https://images.unsplash.com/photo-1551698618-1dfe5d97d256?w=640&q=80',
      ],
      'Dubai': [
        'https://images.unsplash.com/photo-1546519638-68e109498ffc?w=640&q=80',
        'https://images.unsplash.com/photo-1489944440615-453fc2b6a9a9?w=640&q=80',
        'https://images.unsplash.com/photo-1508098682722-e99c643e7f0b?w=640&q=80',
        'https://images.unsplash.com/photo-1574629810360-7efbbe195018?w=640&q=80',
        'https://images.unsplash.com/photo-1529900748604-07564a03e7a6?w=640&q=80',
        'https://images.unsplash.com/photo-1517927033932-b3d18e61fb3a?w=640&q=80',
      ],
      'Sharjah': [
        'https://lh3.googleusercontent.com/gps-cs-s/AHVAweqS6OQey875coBNAykGIbdDsV6Tna7AJ6bmYRDynmo_Y3973TZQmdjeCh2Qp-aLAT_wLo9W9IsgXFItgYHgeKVzVy_ovskTARCP6ebYhd5SQTouPSziA9bLeJrHKnUJZJjbBsf9Bw=s680-w680-h510-rw',
        'https://www.almajaz.ae/assets/images/attractions/falcon-sports.jpg',
        'https://lh3.googleusercontent.com/gps-cs-s/AHVAweoGt1LABqB1Q3PyTGKArPPO3eoscSMHBRs6eEHummQ1X9N_pxw2nWF-yX3askcuyUF4MEvm_2e70g-f-sTH7pBGBJ2yFHGOvnYypq2ahZx3y47s3j4cvbpscSYD4OpeIJ03WsTnRQ=w680-h510-rw',
        'https://images.unsplash.com/photo-1522778119026-d647f0596c20?w=640&q=80',
        'https://images.unsplash.com/photo-1551698618-1dfe5d97d256?w=640&q=80',
      ],
      'Ajman': [
        'https://lh3.googleusercontent.com/gps-cs-s/AHVAweoNXefpFwWvpseySaF1ziagLLTSv6fuFzEqlosR6Tp3fAh6L1pBp4mSBbimMC6JswLgcW0Fg9Sy9UBYD-xvPrWLQ_K1pvTdWKr9P1Dd_yhN_C9COXYcaaBKcXNpOoV_3bj2qDrD=s1360-w1360-h1020-rw',
        'https://lh3.googleusercontent.com/gps-cs-s/AHVAwer_2i2l1I9ueZdR_yv8kKgao7U1lVJWkr4xsx13mq0vtePuYB4phY-Cbr7d77ozb-tSbDxbKDmPc52OT8qE4mr8eYM5b_DjEtkzWPAEqB6RqCFNOJL16HnhIHTxJhzKi8CQje2asA=s1360-w1360-h1020-rw',
        'https://lh3.googleusercontent.com/p/AF1QipONsWuDxVSusY5nxPnB_kNRcJwvGF8BX7t5xEYS=s1360-w1360-h1020-rw',
        'https://lh3.googleusercontent.com/p/AF1QipM-2JcgciIEFQk6fM2J_zWcDmGpVca-V8rrHB8f=w520-h350-n-k-no',
        'https://images.unsplash.com/photo-1574629810360-7efbbe195018?w=640&q=80',
      ],
      'Ras Al Khaimah': [
        'https://images.unsplash.com/photo-1489944440615-453fc2b6a9a9?w=640&q=80',
        'https://images.unsplash.com/photo-1508098682722-e99c643e7f0b?w=640&q=80',
        'https://images.unsplash.com/photo-1529900748604-07564a03e7a6?w=640&q=80',
        'https://images.unsplash.com/photo-1551698618-1dfe5d97d256?w=640&q=80',
        'https://images.unsplash.com/photo-1517927033932-b3d18e61fb3a?w=640&q=80',
      ],
      'Fujairah': [
        'https://images.unsplash.com/photo-1546519638-68e109498ffc?w=640&q=80',
        'https://images.unsplash.com/photo-1574629810360-7efbbe195018?w=640&q=80',
        'https://images.unsplash.com/photo-1522778119026-d647f0596c20?w=640&q=80',
        'https://images.unsplash.com/photo-1517927033932-b3d18e61fb3a?w=640&q=80',
      ],
      'Umm Al Quwain': [
        'https://images.unsplash.com/photo-1529900748604-07564a03e7a6?w=640&q=80',
        'https://images.unsplash.com/photo-1508098682722-e99c643e7f0b?w=640&q=80',
        'https://images.unsplash.com/photo-1489944440615-453fc2b6a9a9?w=640&q=80',
        'https://images.unsplash.com/photo-1551698618-1dfe5d97d256?w=640&q=80',
      ],
    };

    // Photo cache in localStorage
    function getPhotoCache() {
      try { return JSON.parse(localStorage.getItem('hk_photo_cache') || '{}'); }
      catch(e) { return {}; }
    }
    function setPhotoCache(cache) {
      try { localStorage.setItem('hk_photo_cache', JSON.stringify(cache)); }
      catch(e) {}
    }

    function getFieldPhotoUrl(fieldId) {
      const field = DB.fields.find(f => f.id === fieldId);
      if (!field) return null;

      // 1) Use explicit photoUrl on field object
      if (field.photoUrl) return field.photoUrl;

      // 2) Check cache
      const cache = getPhotoCache();
      if (cache[fieldId]) return cache[fieldId];

      // 3) Deterministic selection from emirate photo pool
      const pool = PHOTO_SOURCES[field.emirate] || PHOTO_SOURCES['Dubai'];
      if (!pool || pool.length === 0) return null;

      // Use a stable hash of the fieldId to pick a photo
      let hash = 0;
      for (let i = 0; i < fieldId.length; i++) {
        hash = ((hash << 5) - hash) + fieldId.charCodeAt(i);
        hash |= 0;
      }
      const idx = Math.abs(hash) % pool.length;
      const url = pool[idx];

      // Cache and return
      cache[fieldId] = url;
      setPhotoCache(cache);
      return url;
    }

    // SVG Pitch Generator - fallback
    function generatePitchSVG(fieldId, w = 320, h = 200) {
      const colors = [
        { bg:'#1a5c2a', lines:'#2d8a45', accent:'#43b35f' },
        { bg:'#1a3d5c', lines:'#2a6a99', accent:'#3d9ad1' },
        { bg:'#5c1a3d', lines:'#993060', accent:'#cc4080' },
        { bg:'#3d1a5c', lines:'#6030a0', accent:'#8040d0' },
        { bg:'#1a4a3d', lines:'#2a7a65', accent:'#3db097' },
      ];
      const variant = (fieldId?.charCodeAt(0) || 0) % colors.length;
      const c = colors[variant];
      return `<svg viewBox="0 0 ${w} ${h}" xmlns="http://www.w3.org/2000/svg" class="w-full h-full">
        <rect width="${w}" height="${h}" fill="${c.bg}"/>
        <rect x="10" y="10" width="${w-20}" height="${h-20}" fill="none" stroke="${c.accent}" stroke-width="2" rx="2"/>
        <line x1="${w/2}" y1="10" x2="${w/2}" y2="${h-10}" stroke="${c.accent}" stroke-width="2"/>
        <circle cx="${w/2}" cy="${h/2}" r="${h/5}" fill="none" stroke="${c.accent}" stroke-width="2"/>
        <rect x="10" y="${h/2-h/6}" width="${w/8}" height="${h/3}" fill="none" stroke="${c.accent}" stroke-width="1.5"/>
        <rect x="${w-10-w/8}" y="${h/2-h/6}" width="${w/8}" height="${h/3}" fill="none" stroke="${c.accent}" stroke-width="1.5"/>
      </svg>`;
    }

    // ==========================================
    // STATE MANAGEMENT
    // ==========================================
    let currentPage = 'home';
    let currentLang = localStorage.getItem('hk_lang') || 'en';
    let currentUser = JSON.parse(localStorage.getItem('hk_user') || 'null');
    let selectedField = null;
    let bookingData = JSON.parse(sessionStorage.getItem('hk_checkout') || 'null');
    let searchQuery = '';
    let filterEmirate = '';
    let filterArea = '';
    let filterMaxPrice = 999;

    const defaultConfig = {
      site_title: 'Hajzkoora',
      hero_heading: 'Book Your Perfect Pitch',
      hero_subtext: 'Find and book football fields across the UAE',
    };

    // Translations
    const translations = {
      en: {
        home:'Home', fields:'Fields', login:'Login', signup:'Sign Up', logout:'Logout',
        dashboard:'Dashboard', book_now:'Book Now', search:'Search fields...',
        all_emirates:'All Emirates', all_areas:'All Areas', max_price:'Max Price',
        per_hour:'/hr', indoor:'Indoor', outdoor:'Outdoor', amenities:'Amenities',
        description:'Description', rules:'Rules', turf_type:'Turf Type', pitch_size:'Pitch Size',
        select_date:'Select Date', select_time:'Select Time', duration:'Duration', minutes:'min',
        subtotal:'Subtotal', commission:'Commission (5%)', total:'Total',
        proceed_checkout:'Proceed to Checkout', confirm_booking:'Confirm Booking',
        booking_confirmed:'Booking Confirmed!', show_qr:'Show QR at Venue',
        name:'Name', email:'Email', password:'Password', phone:'Phone', role:'Role',
        player:'Player', field_owner:'Field Owner', admin:'Admin',
        my_bookings:'My Bookings', my_fields:'My Fields', add_field:'Add Field',
        earnings:'Earnings', pending:'Pending', approved:'Approved', rejected:'Rejected',
        approve:'Approve', reject:'Reject', analytics:'Analytics',
        total_bookings:'Total Bookings', total_revenue:'Total Revenue',
        active_fields:'Active Fields', pending_approvals:'Pending Approvals',
        field_name:'Field Name', area:'Area', emirate:'Emirate',
        price_per_hour:'Price/Hour (AED)', submit:'Submit', cancel:'Cancel',
        demo_payment:'⚠️ Demo Payment Mode', welcome_back:'Welcome back',
        hero_cta:'Explore Fields', aed:'AED', no_fields:'No fields found',
        try_adjusting:'Try adjusting your filters', available_slots:'Available Slots',
        booked:'Booked', selected:'Selected', booking_summary:'Booking Summary',
        date:'Date', time:'Time', field_details:'Field Details', back:'Back',
        payment:'Payment', manage_fields:'Manage Fields', manage_owners:'Manage Owners',
        disputes:'Disputes', revenue:'Revenue', payout:'Payout',
        submit_field:'Submit for Approval', field_submitted:'Field submitted for approval!',
        approval_status:'Approval Status', active:'Active', inactive:'Inactive',
        toggle_status:'Toggle Status', no_bookings:'No bookings yet',
        view_details:'View All Fields', price_range:'Price Range', from:'From', to:'To',
        or_login:'Already have an account?', or_signup:"Don't have an account?",
        confirm_delete:'Delete?', yes_delete:'Yes', no_keep:'No',
        booking_id:'Booking ID', status:'Status', confirmed:'Confirmed',
        scan_qr:'Scan this QR code at the venue entrance',
      },
      ar: {
        home:'الرئيسية', fields:'الملاعب', login:'تسجيل الدخول', signup:'إنشاء حساب',
        logout:'تسجيل الخروج', dashboard:'لوحة التحكم', book_now:'احجز الآن',
        search:'ابحث عن ملاعب...', all_emirates:'كل الإمارات', all_areas:'كل المناطق',
        max_price:'أقصى سعر', per_hour:'/ساعة', indoor:'داخلي', outdoor:'خارجي',
        amenities:'المرافق', description:'الوصف', rules:'القوانين', turf_type:'نوع العشب',
        pitch_size:'حجم الملعب', select_date:'اختر التاريخ', select_time:'اختر الوقت',
        duration:'المدة', minutes:'دقيقة', subtotal:'المجموع الفرعي', commission:'العمولة (5%)',
        total:'الإجمالي', proceed_checkout:'المتابعة للدفع', confirm_booking:'تأكيد الحجز',
        booking_confirmed:'تم تأكيد الحجز!', show_qr:'اعرض QR في الملعب',
        name:'الاسم', email:'البريد الإلكتروني', password:'كلمة المرور', phone:'الهاتف',
        role:'الدور', player:'لاعب', field_owner:'مالك ملعب', admin:'مشرف',
        my_bookings:'حجوزاتي', my_fields:'ملاعبي', add_field:'إضافة ملعب',
        earnings:'الأرباح', pending:'قيد الانتظار', approved:'تمت الموافقة',
        rejected:'مرفوض', approve:'موافقة', reject:'رفض', analytics:'التحليلات',
        total_bookings:'إجمالي الحجوزات', total_revenue:'إجمالي الإيرادات',
        active_fields:'الملاعب النشطة', pending_approvals:'الموافقات المعلقة',
        field_name:'اسم الملعب', area:'المنطقة', emirate:'الإمارة',
        price_per_hour:'السعر/ساعة (درهم)', submit:'إرسال', cancel:'إلغاء',
        demo_payment:'⚠️ وضع الدفع التجريبي', welcome_back:'مرحباً بعودتك',
        hero_cta:'استكشف الملاعب', aed:'درهم', no_fields:'لا توجد ملاعب',
        try_adjusting:'حاول تعديل الفلاتر', available_slots:'المواعيد المتاحة',
        booked:'محجوز', selected:'محدد', booking_summary:'ملخص الحجز',
        date:'التاريخ', time:'الوقت', field_details:'تفاصيل الملعب', back:'رجوع',
        payment:'الدفع', manage_fields:'إدارة الملاعب', manage_owners:'إدارة الملاك',
        disputes:'النزاعات', revenue:'الإيرادات', payout:'المدفوعات',
        submit_field:'تقديم للموافقة', field_submitted:'تم تقديم الملعب للموافقة!',
        approval_status:'حالة الموافقة', active:'نشط', inactive:'غير نشط',
        toggle_status:'تبديل الحالة', no_bookings:'لا توجد حجوزات بعد',
        view_details:'عرض جميع الملاعب', price_range:'نطاق السعر', from:'من', to:'إلى',
        or_login:'لديك حساب بالفعل؟', or_signup:'ليس لديك حساب؟',
        confirm_delete:'حذف؟', yes_delete:'نعم', no_keep:'لا',
        booking_id:'رقم الحجز', status:'الحالة', confirmed:'مؤكد',
        scan_qr:'امسح رمز QR عند مدخل الملعب',
      },
      ur: {
        home:'ہوم', fields:'میدان', login:'لاگ ان', signup:'سائن اپ', logout:'لاگ آؤٹ',
        dashboard:'ڈیش بورڈ', book_now:'ابھی بک کریں', search:'میدان تلاش کریں...',
        all_emirates:'تمام امارات', all_areas:'تمام علاقے', max_price:'زیادہ سے زیادہ قیمت',
        per_hour:'/گھنٹہ', indoor:'انڈور', outdoor:'آؤٹ ڈور', amenities:'سہولیات',
        description:'تفصیل', rules:'قواعد', turf_type:'ٹرف کی قسم', pitch_size:'پچ سائز',
        select_date:'تاریخ منتخب کریں', select_time:'وقت منتخب کریں', duration:'مدت',
        minutes:'منٹ', subtotal:'ذیلی کل', commission:'کمیشن (5%)', total:'کل',
        proceed_checkout:'چیک آؤٹ', confirm_booking:'بکنگ کی تصدیق',
        booking_confirmed:'بکنگ کی تصدیق ہو گئی!', show_qr:'میدان میں QR دکھائیں',
        name:'نام', email:'ای میل', password:'پاسورڈ', phone:'فون', role:'کردار',
        player:'کھلاڑی', field_owner:'میدان مالک', admin:'ایڈمن',
        my_bookings:'میری بکنگز', my_fields:'میرے میدان', add_field:'میدان شامل کریں',
        earnings:'آمدنی', pending:'زیر التواء', approved:'منظور', rejected:'مسترد',
        approve:'منظور', reject:'مسترد', analytics:'تجزیات',
        total_bookings:'کل بکنگز', total_revenue:'کل آمدنی',
        active_fields:'فعال میدان', pending_approvals:'زیر التواء منظوری',
        field_name:'میدان کا نام', area:'علاقہ', emirate:'امارت',
        price_per_hour:'قیمت/گھنٹہ (درہم)', submit:'جمع کرائیں', cancel:'منسوخ',
        demo_payment:'⚠️ ڈیمو ادائیگی موڈ', welcome_back:'خوش آمدید',
        hero_cta:'میدان دیکھیں', aed:'درہم', no_fields:'کوئی میدان نہیں ملا',
        try_adjusting:'فلٹرز ایڈجسٹ کریں', available_slots:'دستیاب سلاٹ',
        booked:'بک شدہ', selected:'منتخب', booking_summary:'بکنگ خلاصہ',
        date:'تاریخ', time:'وقت', field_details:'میدان کی تفصیلات', back:'واپس',
        payment:'ادائیگی', manage_fields:'میدان کا انتظام', manage_owners:'مالکان کا انتظام',
        disputes:'تنازعات', revenue:'آمدنی', payout:'ادائیگی',
        submit_field:'منظوری کے لیے جمع کرائیں', field_submitted:'میدان منظوری کے لیے جمع کرا دیا!',
        approval_status:'منظوری کی حالت', active:'فعال', inactive:'غیر فعال',
        toggle_status:'حالت تبدیل کریں', no_bookings:'ابھی تک کوئی بکنگ نہیں',
        view_details:'تمام میدان دیکھیں', price_range:'قیمت کی حد', from:'سے', to:'تک',
        or_login:'پہلے سے اکاؤنٹ ہے؟', or_signup:'اکاؤنٹ نہیں ہے؟',
        confirm_delete:'حذف کریں؟', yes_delete:'ہاں', no_keep:'نہیں',
        booking_id:'بکنگ نمبر', status:'حالت', confirmed:'تصدیق شدہ',
        scan_qr:'میدان کے داخلے پر یہ QR کوڈ اسکین کریں',
      },
    };

    function t(key) {
      return (translations[currentLang] && translations[currentLang][key]) || translations.en[key] || key;
    }

    function changeLanguage(lang) {
      currentLang = lang;
      localStorage.setItem('hk_lang', lang);
      const isRTL = lang === 'ar' || lang === 'ur';
      document.documentElement.dir = isRTL ? 'rtl' : 'ltr';
      document.documentElement.lang = lang;
      const selector = document.getElementById('lang-selector');
      if (selector) selector.value = lang;
      renderPage();
    }

    // UAE LOCATION DATA - All 7 Emirates
    const uaeLocations = {
      'Abu Dhabi': ['Al Reem Island','Khalifa City','Al Mussafah','Yas Island','Saadiyat Island','Al Ain City','Al Shamkha','Mohammed Bin Zayed City','Zayed City','Al Mushrif','Al Nahyan','Tourist Club Area'],
      'Dubai': ['Al Quoz','Jumeirah','Business Bay','Dubai Sports City','Al Barsha','JBR','Deira','Mirdif','Dubai Marina','Al Qusais','Bur Dubai','Oud Metha','International City','Al Warqa','Muhaisnah'],
      'Sharjah': ['Al Nahda','Al Majaz','Al Khan','University City','Muwaileh','Sharjah Industrial','Al Qasimia','Al Taawun','Al Mamzar','Halwan'],
      'Ajman': ['Al Nuaimia','Al Rashidiya','Al Jurf','Emirates City','Al Rawda','Al Hamidiya','Al Mowaihat'],
      'Ras Al Khaimah': ['Al Hamra','Al Nakheel','Khuzam','Al Dhait','Dafan Al Nakheel','Seih Al Uraibi','Al Mairid','Julphar'],
      'Fujairah': ['Fujairah City','Dibba Al Fujairah','Merashid','Qidfa','Mirbah','Al Faseel','Sakamkam'],
      'Umm Al Quwain': ['Old Town','Al Salamah','Umm Al Quwain Marina','Al Raas','Al Humrah','Falaj Al Mualla'],
    };

    // ==========================================
    // DATABASE
    // ==========================================
    let DB = {
      users: [
        { id:'admin1', name:'Admin', email:'admin@hajzkoora.ae', password:'admin123', phone:'+971500000000', role:'admin', approved:true },
        { id:'owner1', name:'Mohammed Al Maktoum', email:'owner@test.ae', password:'owner123', phone:'+971501234567', role:'field_owner', approved:true },
        { id:'owner2', name:'Fatima Al Nahyan', email:'fatima@test.ae', password:'owner123', phone:'+971502345678', role:'field_owner', approved:true },
        { id:'owner3', name:'Khalid Al Marri', email:'khalid@test.ae', password:'owner123', phone:'+971503456789', role:'field_owner', approved:true },
        { id:'player1', name:'Ahmed', email:'player@test.ae', password:'player123', phone:'+971509876543', role:'player', approved:true },
      ],
      fields: [
        // ===== AJMAN (5 fields) =====
        {
          id:'f_aj1', ownerId:'owner1', name:'Football Ground Ajman',
          emirate:'Ajman', area:'Al Nuaimia', lat:25.420, lng:55.440,
          indoor:false, pitchSize:'11v11', turfType:'Natural Grass', price:350,
          amenities:['Changing Rooms','Parking','Floodlights','Water','First Aid'],
          description:'Professional full-size pitch with FIFA-standard natural grass. Perfect for tournaments and league matches in the heart of Al Nuaimia.',
          rules:'No metal studs. No food on pitch. Teams must arrive 15 min early.',
          approved:true, active:true,
        },
        {
          id:'f_aj2', ownerId:'owner1', name:'Al Qemma Stadium',
          emirate:'Ajman', area:'Al Nuaimia', lat:25.422, lng:55.443,
          indoor:false, pitchSize:'7v7', turfType:'Artificial Turf', price:200,
          amenities:['Floodlights','Water','Parking'],
          description:'Premium 7-a-side pitch with top-quality artificial turf. Floodlit and available late evenings.',
          rules:'No glass bottles. Respect the premises and other players.',
          approved:true, active:true,
        },
        {
          id:'f_aj3', ownerId:'owner1', name:'Quattro Sport Center',
          emirate:'Ajman', area:'Al Rashidiya', lat:25.410, lng:55.452,
          indoor:true, pitchSize:'5v5', turfType:'Artificial Turf', price:180,
          amenities:['AC','Changing Rooms','Parking','Cafe','Floodlights'],
          description:'Air-conditioned indoor 5-a-side arena. Beat the heat and play year-round in comfort.',
          rules:'Indoor shoes only. No smoking anywhere on premises.',
          approved:true, active:true,
        },
        {
          id:'f_aj4', ownerId:'owner2', name:'Clasico Football Ground Ajman',
          emirate:'Ajman', area:'Emirates City', lat:25.400, lng:55.460,
          indoor:false, pitchSize:'9v9', turfType:'Hybrid Grass', price:220,
          amenities:['VIP Lounge','Changing Rooms','Parking','Floodlights','Referee'],
          description:'Premium 9-a-side facility with hybrid turf and professional referee services on request.',
          rules:'Advance booking recommended. No pets on pitch.',
          approved:true, active:true,
        },
        {
          id:'f_aj5', ownerId:'owner3', name:'Al Rawda Sports Hub',
          emirate:'Ajman', area:'Al Rawda', lat:25.415, lng:55.435,
          indoor:false, pitchSize:'7v7', turfType:'Artificial Turf', price:160,
          amenities:['Floodlights','Parking','Changing Rooms','Water'],
          description:'Community-focused 7-a-side field popular with local leagues and corporate teams.',
          rules:'No jewellery during play. Children under 16 must be accompanied.',
          approved:true, active:true,
        },
        // ===== SHARJAH (6 fields) =====
        {
          id:'f_sh1', ownerId:'owner1', name:'Sharjah Wanderers Sports Club',
          emirate:'Sharjah', area:'Al Khan', lat:25.350, lng:55.420,
          indoor:false, pitchSize:'11v11', turfType:'Natural Grass', price:300,
          amenities:['Changing Rooms','Parking','Floodlights','Water','First Aid'],
          description:'Historic club with professional-grade pitch. Home to many local Sharjah tournaments since 1976.',
          rules:'Advance booking recommended for weekend slots. Proper kit required.',
          approved:true, active:true,
        },
        {
          id:'f_sh2', ownerId:'owner2', name:'Al Majaz Waterfront Football Field',
          emirate:'Sharjah', area:'Al Majaz', lat:25.360, lng:55.380,
          indoor:false, pitchSize:'9v9', turfType:'Artificial Turf', price:200,
          amenities:['Waterfront View','Floodlights','Water','Parking'],
          description:'Scenic 9-a-side pitch with beautiful waterfront views of Khalid Lagoon. Perfect for evening matches.',
          rules:'No glass bottles. No smoking near the pitch.',
          approved:true, active:true,
        },
        {
          id:'f_sh3', ownerId:'owner1', name:'Falcon Sports Academy',
          emirate:'Sharjah', area:'Al Majaz', lat:25.370, lng:55.390,
          indoor:false, pitchSize:'7v7', turfType:'Hybrid Grass', price:180,
          amenities:['Academy Facilities','Changing Rooms','Parking','Cafe','First Aid'],
          description:'State-of-the-art academy pitch used for professional coaching and team training sessions.',
          rules:'Coaching available on request. Players must wear appropriate footwear.',
          approved:true, active:true,
        },
        {
          id:'f_sh4', ownerId:'owner3', name:'University City Arena',
          emirate:'Sharjah', area:'University City', lat:25.318, lng:55.518,
          indoor:true, pitchSize:'5v5', turfType:'Artificial Turf', price:150,
          amenities:['AC','Changing Rooms','Cafe','Water','Parking'],
          description:'Indoor air-conditioned 5-a-side facility catering to students and university staff.',
          rules:'Student ID may be requested. No outside food.',
          approved:true, active:true,
        },
        {
          id:'f_sh5', ownerId:'owner2', name:'Al Taawun Premier Pitches',
          emirate:'Sharjah', area:'Al Taawun', lat:25.308, lng:55.394,
          indoor:false, pitchSize:'11v11', turfType:'Natural Grass', price:320,
          amenities:['Floodlights','Changing Rooms','Parking','Referee','First Aid','Camera System'],
          description:'Two professional full-size natural grass pitches with camera recording system for team review.',
          rules:'Cleats must be approved before entry. No dogs allowed.',
          approved:true, active:true,
        },
        {
          id:'f_sh6', ownerId:'owner3', name:'Muwaileh Community Ground',
          emirate:'Sharjah', area:'Muwaileh', lat:25.297, lng:55.527,
          indoor:false, pitchSize:'5v5', turfType:'Artificial Turf', price:120,
          amenities:['Parking','Floodlights','Water'],
          description:'Affordable community 5-a-side pitch ideal for casual matches and small group bookings.',
          rules:'Maximum 10 players per booking. Clean up after play.',
          approved:true, active:true,
        },
        // ===== DUBAI (8 fields) =====
        {
          id:'f_db1', ownerId:'owner2', name:'Dubai Sports City Arena',
          emirate:'Dubai', area:'Dubai Sports City', lat:25.050, lng:55.220,
          indoor:false, pitchSize:'11v11', turfType:'Natural Grass', price:450,
          amenities:['Changing Rooms','Parking','Floodlights','Water','First Aid','VIP Box'],
          description:'World-class full-size pitch in Dubai Sports City. Used by semi-professional clubs for league fixtures.',
          rules:'No metal studs. No food or beverages on pitch.',
          approved:true, active:true,
        },
        {
          id:'f_db2', ownerId:'owner1', name:'JBR Beach Pitch',
          emirate:'Dubai', area:'JBR', lat:25.080, lng:55.130,
          indoor:false, pitchSize:'7v7', turfType:'Artificial Turf', price:280,
          amenities:['Beach View','Floodlights','Water','Parking','Cafe'],
          description:'Stunning beachfront 7-a-side pitch with sea views. An unforgettable football experience by the Arabian Gulf.',
          rules:'No glass bottles. Shoes required at all times.',
          approved:true, active:true,
        },
        {
          id:'f_db3', ownerId:'owner3', name:'Al Quoz Indoor Football Hub',
          emirate:'Dubai', area:'Al Quoz', lat:25.148, lng:55.220,
          indoor:true, pitchSize:'5v5', turfType:'Artificial Turf', price:200,
          amenities:['AC','Changing Rooms','Parking','Cafe','Scoreboard'],
          description:'Fully air-conditioned indoor hub with 3 simultaneous 5-a-side pitches. Premium sound system and live scoring.',
          rules:'Indoor turf shoes only. No outdoor cleats.',
          approved:true, active:true,
        },
        {
          id:'f_db4', ownerId:'owner2', name:'Jumeirah Elite Grounds',
          emirate:'Dubai', area:'Jumeirah', lat:25.210, lng:55.240,
          indoor:false, pitchSize:'9v9', turfType:'Hybrid Grass', price:350,
          amenities:['VIP Lounge','Changing Rooms','Parking','Floodlights','Referee','Cafe'],
          description:'Luxury 9-a-side facility with hybrid turf, VIP lounge access and full referee service included.',
          rules:'Smart casual dress code in lounge area. Advance booking required.',
          approved:true, active:true,
        },
        {
          id:'f_db5', ownerId:'owner1', name:'Mirdif City Kick',
          emirate:'Dubai', area:'Mirdif', lat:25.216, lng:55.418,
          indoor:true, pitchSize:'7v7', turfType:'Artificial Turf', price:230,
          amenities:['AC','Changing Rooms','Parking','Water','Cafe'],
          description:'Spacious indoor 7-a-side facility in the family-friendly Mirdif area. Great for corporate leagues.',
          rules:'Family-friendly venue. No aggressive behaviour.',
          approved:true, active:true,
        },
        {
          id:'f_db6', ownerId:'owner3', name:'Deira Community Field',
          emirate:'Dubai', area:'Deira', lat:25.270, lng:55.320,
          indoor:false, pitchSize:'5v5', turfType:'Artificial Turf', price:130,
          amenities:['Floodlights','Water','Parking'],
          description:'No-frills affordable 5-a-side pitch in Deira. Popular with expat workers for evening matches.',
          rules:'No booking required for walk-ins during off-peak hours.',
          approved:true, active:true,
        },
        {
          id:'f_db7', ownerId:'owner2', name:'Business Bay Premier Pitch',
          emirate:'Dubai', area:'Business Bay', lat:25.187, lng:55.264,
          indoor:false, pitchSize:'11v11', turfType:'Natural Grass', price:500,
          amenities:['Changing Rooms','Parking','Floodlights','Water','First Aid','Camera System','Referee'],
          description:'Flagship 11-a-side natural grass pitch with drone camera tracking, ideal for serious clubs and tournament play.',
          rules:'Cleats and shin guards mandatory. Medical form required for new players.',
          approved:true, active:true,
        },
        {
          id:'f_db8', ownerId:'owner1', name:'Al Barsha Sports Park',
          emirate:'Dubai', area:'Al Barsha', lat:25.115, lng:55.203,
          indoor:false, pitchSize:'9v9', turfType:'Artificial Turf', price:240,
          amenities:['Floodlights','Changing Rooms','Parking','Water','Cafe'],
          description:'Well-maintained 9-a-side astroturf pitch in a park setting. Ideal for mixed-ability leagues.',
          rules:'Bookings cancelled within 2 hours forfeit deposit.',
          approved:true, active:true,
        },
        // ===== ABU DHABI (7 fields) =====
        {
          id:'f_ad1', ownerId:'owner1', name:'Yas Island Premium',
          emirate:'Abu Dhabi', area:'Yas Island', lat:24.490, lng:54.600,
          indoor:false, pitchSize:'11v11', turfType:'Hybrid Grass', price:480,
          amenities:['VIP Lounge','Changing Rooms','Parking','Floodlights','Referee','Camera System'],
          description:'Premium 11-a-side facility on Yas Island with hybrid turf and professional camera system. Elite match experience.',
          rules:'Advance booking required. Professional boots recommended.',
          approved:true, active:true,
        },
        {
          id:'f_ad2', ownerId:'owner2', name:'Zayed Sports City Annex',
          emirate:'Abu Dhabi', area:'Al Mushrif', lat:24.440, lng:54.380,
          indoor:false, pitchSize:'11v11', turfType:'Natural Grass', price:400,
          amenities:['Changing Rooms','Parking','Floodlights','Water','First Aid','Tribune'],
          description:'Full-size pitch adjacent to Zayed Sports City with small spectator tribune. Often used for official fixtures.',
          rules:'Registering team names required 24 hrs before booking.',
          approved:true, active:true,
        },
        {
          id:'f_ad3', ownerId:'owner3', name:'Khalifa City Sports Zone',
          emirate:'Abu Dhabi', area:'Khalifa City', lat:24.423, lng:54.542,
          indoor:false, pitchSize:'9v9', turfType:'Artificial Turf', price:260,
          amenities:['Floodlights','Changing Rooms','Parking','Water','Cafe'],
          description:'Modern 9-a-side pitch in one of Abu Dhabi\'s most popular residential areas. Busy evenings, book in advance.',
          rules:'No smoking. Respectful behaviour expected at all times.',
          approved:true, active:true,
        },
        {
          id:'f_ad4', ownerId:'owner1', name:'Al Mussafah Indoor Arena',
          emirate:'Abu Dhabi', area:'Al Mussafah', lat:24.340, lng:54.490,
          indoor:true, pitchSize:'5v5', turfType:'Artificial Turf', price:160,
          amenities:['AC','Changing Rooms','Parking','Water'],
          description:'Budget-friendly air-conditioned indoor pitch catering to industrial area workers and teams.',
          rules:'Indoor shoes only. No metal studs.',
          approved:true, active:true,
        },
        {
          id:'f_ad5', ownerId:'owner2', name:'Saadiyat Beach Sports Club',
          emirate:'Abu Dhabi', area:'Saadiyat Island', lat:24.541, lng:54.434,
          indoor:false, pitchSize:'7v7', turfType:'Hybrid Grass', price:320,
          amenities:['Beach View','Floodlights','Cafe','Parking','Changing Rooms'],
          description:'Beachside 7-a-side hybrid pitch with stunning views. Popular for corporate events and private bookings.',
          rules:'Weekend bookings must be made 48 hrs in advance.',
          approved:true, active:true,
        },
        {
          id:'f_ad6', ownerId:'owner3', name:'Al Ain Desert Sports Ground',
          emirate:'Abu Dhabi', area:'Al Ain City', lat:24.208, lng:55.744,
          indoor:false, pitchSize:'11v11', turfType:'Natural Grass', price:280,
          amenities:['Changing Rooms','Parking','Floodlights','Water','First Aid'],
          description:'Beautiful full-size pitch in Al Ain with mountain backdrop. Open air in cooler conditions than coastal UAE.',
          rules:'Pets not allowed. No alcohol on premises.',
          approved:true, active:true,
        },
        {
          id:'f_ad7', ownerId:'owner1', name:'Tourist Club Arena',
          emirate:'Abu Dhabi', area:'Tourist Club Area', lat:24.489, lng:54.369,
          indoor:true, pitchSize:'7v7', turfType:'Artificial Turf', price:220,
          amenities:['AC','Changing Rooms','Parking','Cafe','Scoreboard'],
          description:'Indoor 7-a-side facility in central Abu Dhabi, accessible from the Corniche. Great for after-work matches.',
          rules:'Booking required. Maximum 16 players per session.',
          approved:true, active:true,
        },
        // ===== RAS AL KHAIMAH (5 fields) =====
        {
          id:'f_rak1', ownerId:'owner2', name:'Al Hamra Sports Village',
          emirate:'Ras Al Khaimah', area:'Al Hamra', lat:25.677, lng:55.770,
          indoor:false, pitchSize:'11v11', turfType:'Natural Grass', price:250,
          amenities:['Changing Rooms','Parking','Floodlights','Water','Mountain Views'],
          description:'Scenic full-size pitch with Hajar Mountain views. Part of the Al Hamra resort complex. Breathtaking sunsets.',
          rules:'Resort guests get priority booking. No studs on indoor areas.',
          approved:true, active:true,
        },
        {
          id:'f_rak2', ownerId:'owner3', name:'Julphar Community Pitch',
          emirate:'Ras Al Khaimah', area:'Julphar', lat:25.780, lng:55.960,
          indoor:false, pitchSize:'7v7', turfType:'Artificial Turf', price:140,
          amenities:['Floodlights','Parking','Water'],
          description:'Affordable and well-lit 7-a-side community pitch. Local leagues meet here every Thursday evening.',
          rules:'Community pitch — be respectful of neighbours.',
          approved:true, active:true,
        },
        {
          id:'f_rak3', ownerId:'owner1', name:'Al Nakheel Indoor Futsal',
          emirate:'Ras Al Khaimah', area:'Al Nakheel', lat:25.796, lng:55.969,
          indoor:true, pitchSize:'5v5', turfType:'Artificial Turf', price:130,
          amenities:['AC','Changing Rooms','Parking','Water'],
          description:'Small but perfectly maintained indoor futsal pitch. One of RAK\'s most popular small-sided venues.',
          rules:'Futsal shoes mandatory. No outdoor footwear.',
          approved:true, active:true,
        },
        {
          id:'f_rak4', ownerId:'owner2', name:'Khuzam Sports Complex',
          emirate:'Ras Al Khaimah', area:'Khuzam', lat:25.758, lng:55.945,
          indoor:false, pitchSize:'9v9', turfType:'Hybrid Grass', price:190,
          amenities:['Changing Rooms','Parking','Floodlights','Water','Cafe'],
          description:'Modern sports complex with hybrid grass 9-a-side pitch and excellent facilities throughout.',
          rules:'Minimum 30 min advance cancellation for refund.',
          approved:true, active:true,
        },
        {
          id:'f_rak5', ownerId:'owner3', name:'Seih Al Uraibi Football Park',
          emirate:'Ras Al Khaimah', area:'Seih Al Uraibi', lat:25.663, lng:55.854,
          indoor:false, pitchSize:'11v11', turfType:'Natural Grass', price:210,
          amenities:['Floodlights','Parking','Water','Changing Rooms'],
          description:'Full-size natural grass pitch set against the dramatic landscape of Ras Al Khaimah\'s interior.',
          rules:'Respect the environment. No litter.',
          approved:true, active:true,
        },
        // ===== FUJAIRAH (5 fields) =====
        {
          id:'f_fj1', ownerId:'owner1', name:'Fujairah Football Complex',
          emirate:'Fujairah', area:'Fujairah City', lat:25.128, lng:56.327,
          indoor:false, pitchSize:'11v11', turfType:'Natural Grass', price:230,
          amenities:['Changing Rooms','Parking','Floodlights','Water','Mountain Views'],
          description:'Main football complex in Fujairah City with full-size natural pitch. Stunning Hajar mountain backdrop.',
          rules:'Only approved boots allowed. No music on pitch.',
          approved:true, active:true,
        },
        {
          id:'f_fj2', ownerId:'owner2', name:'Dibba Oceanside Pitch',
          emirate:'Fujairah', area:'Dibba Al Fujairah', lat:25.621, lng:56.272,
          indoor:false, pitchSize:'7v7', turfType:'Artificial Turf', price:160,
          amenities:['Sea View','Floodlights','Parking','Water'],
          description:'Unique pitch beside the Gulf of Oman. Refreshing sea breeze makes for ideal evening football.',
          rules:'No matches during high tide alerts. Respect coastal rules.',
          approved:true, active:true,
        },
        {
          id:'f_fj3', ownerId:'owner3', name:'Qidfa Indoor Sport Hall',
          emirate:'Fujairah', area:'Qidfa', lat:25.338, lng:56.353,
          indoor:true, pitchSize:'5v5', turfType:'Artificial Turf', price:120,
          amenities:['AC','Parking','Water','Changing Rooms'],
          description:'Air-conditioned indoor hall in the quiet village of Qidfa. Great for small groups and family football.',
          rules:'Children welcome. Adult supervision required under 12.',
          approved:true, active:true,
        },
        {
          id:'f_fj4', ownerId:'owner1', name:'Merashid Community Ground',
          emirate:'Fujairah', area:'Merashid', lat:25.250, lng:56.360,
          indoor:false, pitchSize:'9v9', turfType:'Artificial Turf', price:150,
          amenities:['Floodlights','Parking','Water'],
          description:'Well-maintained 9-a-side astroturf pitch serving the Merashid community and nearby villages.',
          rules:'No aggressive play. Referees can be arranged on request.',
          approved:true, active:true,
        },
        {
          id:'f_fj5', ownerId:'owner2', name:'Al Faseel Sports Hub',
          emirate:'Fujairah', area:'Al Faseel', lat:25.117, lng:56.334,
          indoor:false, pitchSize:'7v7', turfType:'Hybrid Grass', price:170,
          amenities:['Changing Rooms','Parking','Floodlights','Cafe'],
          description:'Modern hybrid grass 7-a-side pitch with great changing facilities and a popular post-match café.',
          rules:'Match-length maximum 2 hours during peak times.',
          approved:true, active:true,
        },
        // ===== UMM AL QUWAIN (5 fields) =====
        {
          id:'f_uaq1', ownerId:'owner3', name:'UAQ Sports Park',
          emirate:'Umm Al Quwain', area:'Old Town', lat:25.565, lng:55.553,
          indoor:false, pitchSize:'11v11', turfType:'Natural Grass', price:180,
          amenities:['Changing Rooms','Parking','Floodlights','Water'],
          description:'The main natural grass pitch in Umm Al Quwain. Quiet, well-priced and ideal for full team fixtures.',
          rules:'Respect the grass — no training drills on the main pitch.',
          approved:true, active:true,
        },
        {
          id:'f_uaq2', ownerId:'owner1', name:'Al Salamah 7-a-Side Ground',
          emirate:'Umm Al Quwain', area:'Al Salamah', lat:25.558, lng:55.570,
          indoor:false, pitchSize:'7v7', turfType:'Artificial Turf', price:120,
          amenities:['Floodlights','Parking','Water'],
          description:'Friendly neighbourhood 7-a-side pitch. UAQ\'s most affordable option for regular group bookings.',
          rules:'Walk-ins welcome during off-peak. Group bookings take priority.',
          approved:true, active:true,
        },
        {
          id:'f_uaq3', ownerId:'owner2', name:'UAQ Marina Football Court',
          emirate:'Umm Al Quwain', area:'Umm Al Quwain Marina', lat:25.579, lng:55.610,
          indoor:false, pitchSize:'5v5', turfType:'Artificial Turf', price:100,
          amenities:['Marina View','Floodlights','Parking'],
          description:'Compact 5-a-side court by the marina. Great for evening kickabouts with a beautiful sunset backdrop.',
          rules:'Maximum 2 consecutive hours per booking at busy times.',
          approved:true, active:true,
        },
        {
          id:'f_uaq4', ownerId:'owner3', name:'Falaj Al Mualla Indoor',
          emirate:'Umm Al Quwain', area:'Falaj Al Mualla', lat:25.530, lng:55.780,
          indoor:true, pitchSize:'5v5', turfType:'Artificial Turf', price:110,
          amenities:['AC','Parking','Water','Changing Rooms'],
          description:'Air-conditioned indoor facility in Falaj Al Mualla. Cool, comfortable and great value.',
          rules:'Indoor footwear only. No outdoor studs.',
          approved:true, active:true,
        },
        {
          id:'f_uaq5', ownerId:'owner1', name:'Al Raas Beach Pitch',
          emirate:'Umm Al Quwain', area:'Al Raas', lat:25.587, lng:55.545,
          indoor:false, pitchSize:'7v7', turfType:'Hybrid Grass', price:140,
          amenities:['Sea View','Floodlights','Parking','Changing Rooms'],
          description:'Hybrid grass pitch by Al Raas beach. A unique Umm Al Quwain experience with gentle sea breezes.',
          rules:'No matches in high wind advisories. Parking limited on weekends.',
          approved:true, active:true,
        },
      ],
      bookings: [
        {
          id:'b1', userId:'player1', fieldId:'f_aj1',
          date:'2025-02-10', time:'18:00', duration:90,
          totalPrice:551.25, status:'confirmed', createdAt:Date.now()-86400000,
        },
      ],
      reviews: [],
      promoCodes: [],
      payments: [
        { id:'pay1', bookingId:'b1', amount:551.25, method:'demo', status:'completed', createdAt:Date.now()-86400000 },
      ],
    };

    // UTILITIES
    function genId() {
      return 'id_' + Date.now().toString(36) + '_' + Math.random().toString(36).slice(2, 7);
    }

    function calcEndTime(startTime, durationMin) {
      const [h, m] = startTime.split(':').map(Number);
      const totalMin = h * 60 + m + durationMin;
      const eh = Math.floor(totalMin / 60) % 24;
      const em = totalMin % 60;
      return `${String(eh).padStart(2,'0')}:${String(em).padStart(2,'0')}`;
    }

    function showToast(message, type = 'success') {
      const container = document.getElementById('toast-container');
      if (!container) return;
      const toast = document.createElement('div');
      const colors = { success:'bg-pitch', error:'bg-red-600', info:'bg-blue-600', warning:'bg-yellow-600' };
      const icons = { success:'✓', error:'✕', info:'ℹ', warning:'⚠' };
      toast.className = `toast-enter flex items-center gap-3 ${colors[type]||colors.success} text-white px-4 py-3 rounded-xl shadow-lg`;
      toast.innerHTML = `<span class="text-lg font-bold">${icons[type]||icons.success}</span><span class="text-sm font-medium">${message}</span>`;
      container.appendChild(toast);
      setTimeout(() => {
        toast.classList.remove('toast-enter');
        toast.classList.add('toast-exit');
        setTimeout(() => toast.remove(), 300);
      }, 3000);
    }

    function showLoading(show) {
      const overlay = document.getElementById('loading-overlay');
      if (!overlay) return;
      overlay.classList.toggle('hidden', !show);
    }

    function getToday() {
      const d = new Date();
      return `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}-${String(d.getDate()).padStart(2,'0')}`;
    }

    // QR Code Generator
    function generateQRCode(text) {
      let hash = 0;
      for (let i = 0; i < text.length; i++) {
        const char = text.charCodeAt(i);
        hash = (hash << 5) - hash + char;
        hash |= 0;
      }
      const seed = Math.abs(hash);
      const size = 21;
      const moduleSize = 8;
      const totalSize = size * moduleSize + 16;
      const modules = Array.from({length:size}, () => Array(size).fill(false));

      function setFinderPattern(row, col) {
        for (let r = 0; r < 7; r++) {
          for (let c = 0; c < 7; c++) {
            if (r===0||r===6||c===0||c===6||(r>=2&&r<=4&&c>=2&&c<=4)) {
              if (row+r < size && col+c < size) modules[row+r][col+c] = true;
            }
          }
        }
      }
      setFinderPattern(0, 0);
      setFinderPattern(0, size - 7);
      setFinderPattern(size - 7, 0);

      let val = seed;
      for (let r = 8; r < size - 8; r++) {
        for (let c = 8; c < size - 8; c++) {
          val = (val * 1103515245 + 12345) & 0x7fffffff;
          modules[r][c] = val % 3 === 0;
        }
      }
      for (let i = 8; i < size - 8; i++) {
        modules[6][i] = i % 2 === 0;
        modules[i][6] = i % 2 === 0;
      }

      let rects = '';
      for (let r = 0; r < size; r++) {
        for (let c = 0; c < size; c++) {
          if (modules[r][c]) {
            rects += `<rect x="${8+c*moduleSize}" y="${8+r*moduleSize}" width="${moduleSize}" height="${moduleSize}" class="qr-module" rx="1"/>`;
          }
        }
      }

      return `<svg viewBox="0 0 ${totalSize} ${totalSize}" xmlns="http://www.w3.org/2000/svg" class="w-full h-full">
        <rect width="${totalSize}" height="${totalSize}" class="qr-bg" rx="8"/>
        ${rects}
      </svg>`;
    }

    // NAVIGATION
    function navigate(page, data) {
      if (data && page === 'field-detail') selectedField = data;
      currentPage = page;
      window.scrollTo(0, 0);
      renderPage();
    }

    // AUTH
    function handleLogin(e) {
      e.preventDefault();
      const email = document.getElementById('login-email').value.trim();
      const password = document.getElementById('login-password').value;
      const user = DB.users.find(u => u.email === email && u.password === password);
      if (!user) { showToast('Invalid email or password', 'error'); return; }
      if (user.role === 'field_owner' && !user.approved) { showToast('Your account is pending approval', 'warning'); return; }
      currentUser = user;
      localStorage.setItem('hk_user', JSON.stringify(user));
      showToast(`${t('welcome_back')}, ${user.name}!`);
      navigate('home');
    }

    function handleSignup(e) {
      e.preventDefault();
      const name = document.getElementById('signup-name').value.trim();
      const email = document.getElementById('signup-email').value.trim();
      const password = document.getElementById('signup-password').value;
      const phone = document.getElementById('signup-phone').value.trim();
      const role = document.getElementById('signup-role').value;
      if (!name || !email || !password || !phone) { showToast('Please fill all fields', 'error'); return; }
      if (DB.users.find(u => u.email === email)) { showToast('Email already registered', 'error'); return; }
      const newUser = { id:genId(), name, email, password, phone, role, approved: role==='player' };
      DB.users.push(newUser);
      if (role === 'player') {
        currentUser = newUser;
        localStorage.setItem('hk_user', JSON.stringify(newUser));
        showToast(`Welcome to Hajzkoora, ${name}!`);
        navigate('home');
      } else {
        showToast('Account created! Pending admin approval.', 'info');
        navigate('login');
      }
    }

    function handleLogout() {
      currentUser = null;
      localStorage.removeItem('hk_user');
      sessionStorage.removeItem('hk_checkout');
      showToast(t('logout') + '!', 'info');
      navigate('home');
    }

    // BOOKING
    function getBookedSlots(fieldId, date) {
      return DB.bookings.filter(b => b.fieldId === fieldId && b.date === date && b.status === 'confirmed').map(b => b.time);
    }

    function handleBooking(fieldId, date, time, duration) {
      if (!currentUser) { showToast('Please login to book', 'warning'); navigate('login'); return; }
      const field = DB.fields.find(f => f.id === fieldId);
      if (!field) return;
      const durationMultiplier = duration / 60;
      const subtotal = field.price * durationMultiplier;
      const commission = subtotal * 0.05;
      const total = subtotal + commission;
      const checkout = {
        fieldId, fieldName:field.name, date, time, duration,
        endTime:calcEndTime(time, duration), subtotal, commission, total,
        emirate:field.emirate, area:field.area,
      };
      sessionStorage.setItem('hk_checkout', JSON.stringify(checkout));
      bookingData = checkout;
      navigate('checkout');
    }

    function confirmBooking() {
      if (!bookingData || !currentUser) return;
      showLoading(true);
      setTimeout(() => {
        const booking = {
          id:genId(), userId:currentUser.id, fieldId:bookingData.fieldId,
          date:bookingData.date, time:bookingData.time, duration:bookingData.duration,
          totalPrice:bookingData.total, status:'confirmed', createdAt:Date.now(),
        };
        DB.bookings.push(booking);
        DB.payments.push({ id:genId(), bookingId:booking.id, amount:bookingData.total, method:'demo', status:'completed', createdAt:Date.now() });
        sessionStorage.removeItem('hk_checkout');
        showLoading(false);
        showToast(t('booking_confirmed'), 'success');
        navigate('booking-confirmed', booking);
      }, 800);
    }

    // RENDER
    function renderNav() {
      const nav = document.getElementById('nav-links');
      if (!nav) return;
      let links = '';
      if (currentUser) {
        const dashPage = currentUser.role==='admin' ? 'admin-dashboard' : currentUser.role==='field_owner' ? 'owner-dashboard' : 'player-dashboard';
        links = `
          <button onclick="navigate('fields')" class="text-sand/70 hover:text-pitch text-sm font-medium transition-colors">${t('fields')}</button>
          <button onclick="navigate('${dashPage}')" class="text-sand/70 hover:text-pitch text-sm font-medium transition-colors">${t('dashboard')}</button>
          <div class="flex items-center gap-2 ml-2 pl-2 border-l border-sand/10">
            <div class="w-7 h-7 rounded-full bg-pitch/20 flex items-center justify-center text-pitch text-xs font-bold">${currentUser.name.charAt(0)}</div>
            <button onclick="handleLogout()" class="text-red-400/70 hover:text-red-400 text-xs font-medium transition-colors">${t('logout')}</button>
          </div>`;
      } else {
        links = `
          <button onclick="navigate('fields')" class="text-sand/70 hover:text-pitch text-sm font-medium transition-colors">${t('fields')}</button>
          <button onclick="navigate('login')" class="text-sand/70 hover:text-pitch text-sm font-medium transition-colors">${t('login')}</button>
          <button onclick="navigate('signup')" class="btn-primary text-white text-sm font-semibold px-4 py-1.5 rounded-lg">${t('signup')}</button>`;
      }
      nav.innerHTML = links;
    }

    function renderPage() {
      renderNav();
      const main = document.getElementById('main-content');
      if (!main) return;
      switch (currentPage) {
        case 'home': main.innerHTML = renderHome(); break;
        case 'fields': main.innerHTML = renderFields(); initFieldFilters(); break;
        case 'field-detail': main.innerHTML = renderFieldDetail(); initBookingWidget(); break;
        case 'checkout': main.innerHTML = renderCheckout(); break;
        case 'booking-confirmed': main.innerHTML = renderBookingConfirmed(); break;
        case 'login': main.innerHTML = renderLogin(); break;
        case 'signup': main.innerHTML = renderSignup(); break;
        case 'player-dashboard': main.innerHTML = renderPlayerDashboard(); break;
        case 'owner-dashboard': main.innerHTML = renderOwnerDashboard(); initOwnerDashboard(); break;
        case 'admin-dashboard': main.innerHTML = renderAdminDashboard(); initAdminDashboard(); break;
        default: main.innerHTML = renderHome();
      }
    }

    // HOME PAGE
    function renderHome() {
      const heading = defaultConfig.hero_heading;
      const sub = defaultConfig.hero_subtext;
      const topFields = DB.fields.filter(f => f.approved && f.active).slice(0, 4);
      const emirateCounts = Object.keys(uaeLocations).map(em => ({
        em, count: DB.fields.filter(f => f.emirate === em && f.approved).length
      })).filter(x => x.count > 0);

      return `
        <section class="hero-bg w-full" style="min-height:60%;">
          <div class="relative z-10 max-w-6xl mx-auto px-4 py-16 sm:py-24 flex flex-col items-center text-center">
            <div class="anim-fade-up" style="animation-delay:0.1s;">
              <span class="inline-block px-4 py-1 rounded-full text-xs font-semibold tracking-wider uppercase mb-6" style="background:rgba(13,155,74,0.15);color:#43b35f;border:1px solid rgba(13,155,74,0.3);">
                🏟️ UAE's #1 Football Booking Platform
              </span>
            </div>
            <h1 class="anim-fade-up text-4xl sm:text-5xl md:text-6xl font-extrabold text-white leading-tight mb-4" style="animation-delay:0.2s;">${heading}</h1>
            <p class="anim-fade-up text-lg sm:text-xl text-sand/60 max-w-xl mb-8" style="animation-delay:0.3s;">${sub}</p>
            <div class="anim-fade-up flex flex-col sm:flex-row gap-3" style="animation-delay:0.4s;">
              <button onclick="navigate('fields')" class="btn-primary text-white font-bold px-8 py-3 rounded-xl text-lg">${t('hero_cta')} →</button>
              ${!currentUser ? `<button onclick="navigate('signup')" class="btn-accent text-white font-bold px-8 py-3 rounded-xl text-lg">${t('signup')}</button>` : ''}
            </div>
            <div class="anim-fade-up mt-12 grid grid-cols-3 gap-8 text-center" style="animation-delay:0.5s;">
              <div>
                <div class="text-3xl font-extrabold text-pitch">${DB.fields.filter(f=>f.approved).length}+</div>
                <div class="text-sand/40 text-sm">${t('fields')}</div>
              </div>
              <div>
                <div class="text-3xl font-extrabold text-pitch">7</div>
                <div class="text-sand/40 text-sm">${t('all_emirates')}</div>
              </div>
              <div>
                <div class="text-3xl font-extrabold text-pitch">${DB.bookings.length}+</div>
                <div class="text-sand/40 text-sm">${t('total_bookings')}</div>
              </div>
            </div>
          </div>
        </section>

        <section class="w-full py-8 px-4 bg-midnightLight/30">
          <div class="max-w-6xl mx-auto">
            <h2 class="text-lg font-semibold text-sand/50 mb-4 text-center tracking-widest uppercase text-sm">Browse by Emirate</h2>
            <div class="flex flex-wrap justify-center gap-3">
              ${emirateCounts.map(({em, count}) => `
                <button onclick="filterEmirate='${em}'; navigate('fields');"
                  class="glass-card px-4 py-2 rounded-xl text-sm font-semibold text-sand/70 hover:text-pitch hover:border-pitch/40 transition-all">
                  ${em} <span class="text-pitch ml-1">${count}</span>
                </button>
              `).join('')}
            </div>
          </div>
        </section>

        <section class="w-full py-12 px-4">
          <div class="max-w-6xl mx-auto">
            <h2 class="text-2xl font-bold text-white mb-8">⚽ Featured ${t('fields')}</h2>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-5">
              ${topFields.map((f,i) => renderFieldCard(f, i)).join('')}
            </div>
            <div class="text-center mt-8">
              <button onclick="navigate('fields')" class="text-pitch hover:text-pitchLight font-semibold transition-colors">${t('view_details')} →</button>
            </div>
          </div>
        </section>
      `;
    }

    function renderFieldCard(field, idx) {
      const photoUrl = getFieldPhotoUrl(field.id);
      return `
        <div class="field-card glass-card rounded-2xl overflow-hidden cursor-pointer anim-fade-up" style="animation-delay:${idx*0.08}s;" onclick="navigate('field-detail','${field.id}')">
          <div class="field-image-container">
            ${photoUrl
              ? `<img src="${photoUrl}" alt="${field.name}" loading="lazy"
                  onerror="this.style.display='none';this.nextElementSibling.style.display='block';">
                <div style="display:none;">${generatePitchSVG(field.id, 400, 200)}</div>`
              : generatePitchSVG(field.id, 400, 200)}
            <div class="image-overlay"></div>
            <div class="absolute top-3 left-3">
              <span class="badge ${field.indoor ? 'bg-blue-500/80 text-white' : 'bg-green-500/80 text-white'}">${field.indoor ? t('indoor') : t('outdoor')}</span>
            </div>
            <div class="absolute bottom-3 right-3 bg-midnight/80 backdrop-blur-sm text-pitch font-bold px-3 py-1 rounded-lg text-sm">
              ${field.price} ${t('aed')}${t('per_hour')}
            </div>
          </div>
          <div class="p-4">
            <h3 class="text-white font-bold text-sm mb-1 truncate">${field.name}</h3>
            <p class="text-sand/50 text-xs mb-3">📍 ${field.area}, ${field.emirate}</p>
            <div class="flex items-center justify-between">
              <span class="text-sand/40 text-xs">${field.pitchSize}</span>
              <button class="btn-primary text-white text-xs font-semibold px-3 py-1 rounded-lg">${t('book_now')}</button>
            </div>
          </div>
        </div>
      `;
    }

    // FIELDS LISTING
    function renderFields() {
      const emirates = Object.keys(uaeLocations);
      return `
        <div class="w-full py-6 px-4">
          <div class="max-w-6xl mx-auto">
            <h1 class="text-3xl font-bold text-white mb-6">⚽ ${t('fields')} <span class="text-sand/30 text-xl font-normal ml-2">${DB.fields.filter(f=>f.approved&&f.active).length} available</span></h1>
            <div class="glass-card rounded-xl p-4 mb-6">
              <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3">
                <div>
                  <label for="search-input" class="text-sand/50 text-xs mb-1 block">${t('search')}</label>
                  <input id="search-input" type="text" placeholder="${t('search')}" class="input-field w-full px-3 py-2 rounded-lg text-sm" value="${searchQuery}"
                    oninput="searchQuery=this.value; filterFields()">
                </div>
                <div>
                  <label for="filter-emirate" class="text-sand/50 text-xs mb-1 block">${t('emirate')}</label>
                  <select id="filter-emirate" class="input-field w-full px-3 py-2 rounded-lg text-sm"
                    onchange="filterEmirate=this.value; filterArea=''; updateAreaDropdown(); filterFields()">
                    <option value="">${t('all_emirates')}</option>
                    ${emirates.map(e => `<option value="${e}" ${filterEmirate===e?'selected':''}>${e}</option>`).join('')}
                  </select>
                </div>
                <div>
                  <label for="filter-area" class="text-sand/50 text-xs mb-1 block">${t('area')}</label>
                  <select id="filter-area" class="input-field w-full px-3 py-2 rounded-lg text-sm"
                    onchange="filterArea=this.value; filterFields()">
                    <option value="">${t('all_areas')}</option>
                  </select>
                </div>
                <div>
                  <label for="filter-price" class="text-sand/50 text-xs mb-1 block">${t('max_price')}: <span id="price-display">${filterMaxPrice===999?'Any':filterMaxPrice}</span> ${t('aed')}</label>
                  <input id="filter-price" type="range" min="50" max="600" value="${filterMaxPrice===999?600:filterMaxPrice}" class="w-full mt-2 accent-pitch"
                    oninput="filterMaxPrice=Number(this.value)===600?999:Number(this.value); document.getElementById('price-display').textContent=Number(this.value)===600?'Any':this.value; filterFields()">
                </div>
              </div>
            </div>
            <div id="fields-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5"></div>
            <div id="no-fields" class="hidden text-center py-16">
              <div class="text-4xl mb-4">🏟️</div>
              <p class="text-sand/50 text-lg">${t('no_fields')}</p>
              <p class="text-sand/30 text-sm mt-1">${t('try_adjusting')}</p>
            </div>
          </div>
        </div>
      `;
    }

    function initFieldFilters() {
      updateAreaDropdown();
      filterFields();
    }

    function updateAreaDropdown() {
      const areaSelect = document.getElementById('filter-area');
      if (!areaSelect) return;
      const areas = filterEmirate ? uaeLocations[filterEmirate] || [] : Object.values(uaeLocations).flat();
      areaSelect.innerHTML = `<option value="">${t('all_areas')}</option>` + areas.map(a => `<option value="${a}" ${filterArea===a?'selected':''}>${a}</option>`).join('');
    }

    function filterFields() {
      const grid = document.getElementById('fields-grid');
      const noFields = document.getElementById('no-fields');
      if (!grid || !noFields) return;
      const q = searchQuery.toLowerCase();
      const filtered = DB.fields.filter(f => {
        if (!f.approved || !f.active) return false;
        if (filterEmirate && f.emirate !== filterEmirate) return false;
        if (filterArea && f.area !== filterArea) return false;
        if (filterMaxPrice < 999 && f.price > filterMaxPrice) return false;
        if (q && !(
          f.name.toLowerCase().includes(q) ||
          f.area.toLowerCase().includes(q) ||
          f.emirate.toLowerCase().includes(q) ||
          f.description.toLowerCase().includes(q) ||
          f.pitchSize.toLowerCase().includes(q) ||
          (f.amenities||[]).join(' ').toLowerCase().includes(q)
        )) return false;
        return true;
      });
      if (filtered.length === 0) {
        grid.innerHTML = '';
        grid.classList.add('hidden');
        noFields.classList.remove('hidden');
      } else {
        noFields.classList.add('hidden');
        grid.classList.remove('hidden');
        grid.innerHTML = filtered.map((f,i) => renderFieldCard(f, i)).join('');
      }
    }

    // FIELD DETAIL
    function renderFieldDetail() {
      const field = DB.fields.find(f => f.id === selectedField);
      if (!field) {
        return `<div class="text-center py-20 text-sand/50">Field not found. <button onclick="navigate('fields')" class="text-pitch underline">${t('back')}</button></div>`;
      }
      const photoUrl = getFieldPhotoUrl(field.id);
      return `
        <div class="w-full py-6 px-4">
          <div class="max-w-6xl mx-auto">
            <button onclick="navigate('fields')" class="text-sand/50 hover:text-pitch text-sm mb-4 inline-flex items-center gap-1 transition-colors">← ${t('back')}</button>
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
              <div class="lg:col-span-2 space-y-4">
                <div class="glass-card rounded-2xl overflow-hidden">
                  <div class="h-64 overflow-hidden">
                    ${photoUrl
                      ? `<img src="${photoUrl}" alt="${field.name}" class="w-full h-full object-cover" loading="lazy"
                          onerror="this.style.display='none';this.nextElementSibling.style.display='block';">
                        <div style="display:none;">${generatePitchSVG(field.id, 800, 320)}</div>`
                      : generatePitchSVG(field.id, 800, 320)}
                  </div>
                  <div class="p-6">
                    <div class="flex items-start justify-between mb-3">
                      <div>
                        <h1 class="text-2xl font-bold text-white">${field.name}</h1>
                        <p class="text-sand/50 text-sm mt-1">📍 ${field.area}, ${field.emirate}</p>
                      </div>
                      <span class="badge ${field.indoor ? 'bg-blue-500/80 text-white' : 'bg-green-500/80 text-white'} text-sm">${field.indoor ? t('indoor') : t('outdoor')}</span>
                    </div>
                    <div class="grid grid-cols-2 sm:grid-cols-4 gap-3 my-4">
                      <div class="text-center p-3 rounded-lg" style="background:rgba(13,155,74,0.1);">
                        <div class="text-pitch font-bold text-lg">${field.price}</div>
                        <div class="text-sand/40 text-xs">${t('aed')}${t('per_hour')}</div>
                      </div>
                      <div class="text-center p-3 rounded-lg" style="background:rgba(13,155,74,0.1);">
                        <div class="text-pitch font-bold text-lg">${field.pitchSize}</div>
                        <div class="text-sand/40 text-xs">${t('pitch_size')}</div>
                      </div>
                      <div class="text-center p-3 rounded-lg" style="background:rgba(13,155,74,0.1);">
                        <div class="text-pitch font-bold text-base">${field.turfType.split(' ')[0]}</div>
                        <div class="text-sand/40 text-xs">${t('turf_type')}</div>
                      </div>
                      <div class="text-center p-3 rounded-lg" style="background:rgba(13,155,74,0.1);">
                        <div class="text-pitch font-bold text-lg">${field.indoor ? '❄️' : '☀️'}</div>
                        <div class="text-sand/40 text-xs">${field.indoor ? t('indoor') : t('outdoor')}</div>
                      </div>
                    </div>
                    <div class="mb-4">
                      <h3 class="text-white font-semibold mb-2">${t('description')}</h3>
                      <p class="text-sand/60 text-sm leading-relaxed">${field.description}</p>
                    </div>
                    <div class="mb-4">
                      <h3 class="text-white font-semibold mb-2">${t('amenities')}</h3>
                      <div class="flex flex-wrap gap-2">
                        ${(field.amenities||[]).map(a => `<span class="badge bg-midnightLight text-sand/70 text-xs">✓ ${a}</span>`).join('')}
                      </div>
                    </div>
                    ${field.rules ? `<div><h3 class="text-white font-semibold mb-2">${t('rules')}</h3><p class="text-sand/50 text-sm">${field.rules}</p></div>` : ''}
                  </div>
                </div>
              </div>
              <div class="lg:col-span-1">
                <div class="glass-card rounded-2xl p-5 sticky top-20">
                  <h3 class="text-white font-bold text-lg mb-4">📅 ${t('book_now')}</h3>
                  <div class="space-y-4">
                    <div>
                      <label for="booking-date" class="text-sand/50 text-xs mb-1 block">${t('select_date')}</label>
                      <input id="booking-date" type="date" min="${getToday()}" class="input-field w-full px-3 py-2 rounded-lg text-sm"
                        onchange="updateTimeSlots('${field.id}')">
                    </div>
                    <div>
                      <label for="booking-duration" class="text-sand/50 text-xs mb-1 block">${t('duration')}</label>
                      <select id="booking-duration" class="input-field w-full px-3 py-2 rounded-lg text-sm"
                        onchange="updateTimeSlots('${field.id}')">
                        <option value="60">60 ${t('minutes')}</option>
                        <option value="90" selected>90 ${t('minutes')}</option>
                        <option value="120">120 ${t('minutes')}</option>
                      </select>
                    </div>
                    <div>
                      <label class="text-sand/50 text-xs mb-2 block">${t('select_time')}</label>
                      <div id="time-slots" class="grid grid-cols-3 gap-2 max-h-48 overflow-auto pr-1">
                        <p class="text-sand/30 text-xs col-span-3 text-center py-4">${t('select_date')}</p>
                      </div>
                    </div>
                    <div id="booking-summary-widget" class="hidden border-t border-sand/10 pt-4 mt-4">
                      <div class="space-y-2 text-sm">
                        <div class="flex justify-between text-sand/60"><span>${t('subtotal')}</span><span id="widget-subtotal">-</span></div>
                        <div class="flex justify-between text-sand/60"><span>${t('commission')}</span><span id="widget-commission">-</span></div>
                        <div class="flex justify-between text-white font-bold text-base border-t border-sand/10 pt-2"><span>${t('total')}</span><span id="widget-total">-</span></div>
                      </div>
                      <button id="btn-proceed" class="btn-primary w-full text-white font-bold py-3 rounded-xl mt-4"
                        onclick="proceedToCheckout('${field.id}')">${t('proceed_checkout')}</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      `;
    }

    let selectedTimeSlot = null;
    function initBookingWidget() { selectedTimeSlot = null; }

    function updateTimeSlots(fieldId) {
      const dateInput = document.getElementById('booking-date');
      const durationSelect = document.getElementById('booking-duration');
      const slotsContainer = document.getElementById('time-slots');
      const summary = document.getElementById('booking-summary-widget');
      if (!dateInput || !dateInput.value || !durationSelect || !slotsContainer || !summary) return;
      const date = dateInput.value;
      const duration = Number(durationSelect.value);
      const booked = getBookedSlots(fieldId, date);
      selectedTimeSlot = null;
      summary.classList.add('hidden');
      const slots = [];
      for (let h = 6; h <= 22; h++) {
        const time = `${String(h).padStart(2,'0')}:00`;
        const endH = h + Math.ceil(duration / 60);
        if (endH > 23) continue;
        slots.push({ time, isBooked: booked.includes(time) });
      }
      slotsContainer.innerHTML = slots.map(s => `
        <button class="slot-btn border rounded-lg px-2 py-2 text-xs font-medium text-center transition-all
          ${s.isBooked ? 'border-red-500/30 text-red-400/50 bg-red-500/5' : 'border-sand/15 text-sand/70 hover:border-pitch hover:text-pitch'}"
          ${s.isBooked ? 'disabled' : `onclick="selectSlot('${fieldId}','${s.time}',this)"`}>
          ${s.time}
        </button>
      `).join('');
    }

    function selectSlot(fieldId, time, btn) {
      document.querySelectorAll('.slot-btn.selected').forEach(b => b.classList.remove('selected'));
      btn.classList.add('selected');
      selectedTimeSlot = time;
      const field = DB.fields.find(f => f.id === fieldId);
      const duration = Number(document.getElementById('booking-duration').value);
      const multiplier = duration / 60;
      const subtotal = field.price * multiplier;
      const commission = subtotal * 0.05;
      const total = subtotal + commission;
      document.getElementById('widget-subtotal').textContent = `${subtotal.toFixed(2)} ${t('aed')}`;
      document.getElementById('widget-commission').textContent = `${commission.toFixed(2)} ${t('aed')}`;
      document.getElementById('widget-total').textContent = `${total.toFixed(2)} ${t('aed')}`;
      document.getElementById('booking-summary-widget').classList.remove('hidden');
    }

    function proceedToCheckout(fieldId) {
      if (!selectedTimeSlot) { showToast(t('select_time'), 'warning'); return; }
      const date = document.getElementById('booking-date').value;
      const duration = Number(document.getElementById('booking-duration').value);
      handleBooking(fieldId, date, selectedTimeSlot, duration);
    }

    // CHECKOUT
    function renderCheckout() {
      if (!bookingData) {
        return `<div class="text-center py-20 text-sand/50">No booking data. <button onclick="navigate('fields')" class="text-pitch underline">${t('fields')}</button></div>`;
      }
      return `
        <div class="w-full py-6 px-4">
          <div class="max-w-lg mx-auto">
            <div class="glass-card rounded-2xl p-6 anim-fade-up">
              <div class="text-center mb-6">
                <div class="inline-block px-3 py-1 rounded-full text-xs font-semibold bg-yellow-500/20 text-yellow-400 border border-yellow-500/30 mb-4">${t('demo_payment')}</div>
                <h1 class="text-2xl font-bold text-white">${t('booking_summary')}</h1>
              </div>
              <div class="space-y-3 mb-6">
                <div class="flex justify-between text-sm"><span class="text-sand/50">🏟️ ${t('field_name')}</span><span class="text-white font-medium">${bookingData.fieldName}</span></div>
                <div class="flex justify-between text-sm"><span class="text-sand/50">📍 ${t('area')}</span><span class="text-white font-medium">${bookingData.area}, ${bookingData.emirate}</span></div>
                <div class="flex justify-between text-sm"><span class="text-sand/50">📅 ${t('date')}</span><span class="text-white font-medium">${bookingData.date}</span></div>
                <div class="flex justify-between text-sm"><span class="text-sand/50">⏰ ${t('time')}</span><span class="text-white font-medium">${bookingData.time} → ${bookingData.endTime}</span></div>
                <div class="flex justify-between text-sm"><span class="text-sand/50">⏱️ ${t('duration')}</span><span class="text-white font-medium">${bookingData.duration} ${t('minutes')}</span></div>
              </div>
              <div class="border-t border-sand/10 pt-4 space-y-2">
                <div class="flex justify-between text-sm"><span class="text-sand/60">${t('subtotal')}</span><span class="text-sand">${bookingData.subtotal.toFixed(2)} ${t('aed')}</span></div>
                <div class="flex justify-between text-sm"><span class="text-sand/60">${t('commission')}</span><span class="text-sand">${bookingData.commission.toFixed(2)} ${t('aed')}</span></div>
                <div class="flex justify-between text-lg font-bold border-t border-sand/10 pt-3"><span class="text-white">${t('total')}</span><span class="text-pitch">${bookingData.total.toFixed(2)} ${t('aed')}</span></div>
              </div>
              <div class="mt-6 flex gap-3">
                <button onclick="navigate('fields')" class="flex-1 border border-sand/20 text-sand/70 font-semibold py-3 rounded-xl hover:border-sand/40 transition-colors">${t('cancel')}</button>
                <button onclick="confirmBooking()" class="flex-1 btn-accent text-white font-bold py-3 rounded-xl">${t('confirm_booking')}</button>
              </div>
            </div>
          </div>
        </div>
      `;
    }

    // BOOKING CONFIRMED
    function renderBookingConfirmed() {
      const booking = DB.bookings[DB.bookings.length - 1];
      if (!booking) return '';
      const field = DB.fields.find(f => f.id === booking.fieldId);
      return `
        <div class="w-full py-8 px-4">
          <div class="max-w-md mx-auto text-center">
            <div class="glass-card rounded-2xl p-8 anim-bounce">
              <div class="text-5xl mb-4">🎉</div>
              <h1 class="text-2xl font-bold text-white mb-2">${t('booking_confirmed')}</h1>
              <p class="text-sand/50 text-sm mb-6">${t('scan_qr')}</p>
              <div class="w-48 h-48 mx-auto mb-6 p-3 bg-white/5 rounded-2xl" style="animation:pulse-glow 2s ease-in-out infinite;">
                ${generateQRCode(booking.id + booking.date + booking.time)}
              </div>
              <div class="text-left space-y-2 mb-6">
                <div class="flex justify-between text-sm"><span class="text-sand/50">${t('booking_id')}</span><span class="text-pitch font-mono text-xs">${booking.id}</span></div>
                <div class="flex justify-between text-sm"><span class="text-sand/50">🏟️</span><span class="text-white">${field ? field.name : ''}</span></div>
                <div class="flex justify-between text-sm"><span class="text-sand/50">📅</span><span class="text-white">${booking.date}</span></div>
                <div class="flex justify-between text-sm"><span class="text-sand/50">⏰</span><span class="text-white">${booking.time} (${booking.duration}${t('minutes')})</span></div>
                <div class="flex justify-between text-sm"><span class="text-sand/50">${t('status')}</span><span class="text-green-400 font-semibold">${t('confirmed')} ✓</span></div>
              </div>
              <button onclick="navigate('home')" class="btn-primary w-full text-white font-bold py-3 rounded-xl">${t('home')}</button>
            </div>
          </div>
        </div>
      `;
    }

    // LOGIN
    function renderLogin() {
      return `
        <div class="w-full py-12 px-4">
          <div class="max-w-sm mx-auto">
            <div class="glass-card rounded-2xl p-6 anim-fade-up">
              <h1 class="text-2xl font-bold text-white text-center mb-6">${t('login')}</h1>
              <form onsubmit="handleLogin(event)" class="space-y-4">
                <div>
                  <label for="login-email" class="text-sand/50 text-xs mb-1 block">${t('email')}</label>
                  <input id="login-email" type="email" required class="input-field w-full px-3 py-2.5 rounded-lg text-sm" placeholder="you@email.com">
                </div>
                <div>
                  <label for="login-password" class="text-sand/50 text-xs mb-1 block">${t('password')}</label>
                  <input id="login-password" type="password" required class="input-field w-full px-3 py-2.5 rounded-lg text-sm" placeholder="••••••••">
                </div>
                <button type="submit" class="btn-primary w-full text-white font-bold py-3 rounded-xl">${t('login')}</button>
              </form>
              <p class="text-center text-sand/40 text-sm mt-4">${t('or_signup')}
                <button onclick="navigate('signup')" class="text-pitch hover:underline">${t('signup')}</button>
              </p>
              <div class="mt-4 p-3 rounded-lg bg-pitch/5 border border-pitch/10">
                <p class="text-sand/40 text-xs mb-1 font-semibold">Demo Accounts:</p>
                <p class="text-sand/30 text-xs">Player: player@test.ae / player123</p>
                <p class="text-sand/30 text-xs">Owner: owner@test.ae / owner123</p>
                <p class="text-sand/30 text-xs">Admin: admin@hajzkoora.ae / admin123</p>
              </div>
            </div>
          </div>
        </div>
      `;
    }

    // SIGNUP
    function renderSignup() {
      return `
        <div class="w-full py-12 px-4">
          <div class="max-w-sm mx-auto">
            <div class="glass-card rounded-2xl p-6 anim-fade-up">
              <h1 class="text-2xl font-bold text-white text-center mb-6">${t('signup')}</h1>
              <form onsubmit="handleSignup(event)" class="space-y-4">
                <div>
                  <label for="signup-name" class="text-sand/50 text-xs mb-1 block">${t('name')}</label>
                  <input id="signup-name" type="text" required class="input-field w-full px-3 py-2.5 rounded-lg text-sm">
                </div>
                <div>
                  <label for="signup-email" class="text-sand/50 text-xs mb-1 block">${t('email')}</label>
                  <input id="signup-email" type="email" required class="input-field w-full px-3 py-2.5 rounded-lg text-sm">
                </div>
                <div>
                  <label for="signup-password" class="text-sand/50 text-xs mb-1 block">${t('password')}</label>
                  <input id="signup-password" type="password" required minlength="6" class="input-field w-full px-3 py-2.5 rounded-lg text-sm">
                </div>
                <div>
                  <label for="signup-phone" class="text-sand/50 text-xs mb-1 block">${t('phone')}</label>
                  <input id="signup-phone" type="tel" required class="input-field w-full px-3 py-2.5 rounded-lg text-sm" placeholder="+971...">
                </div>
                <div>
                  <label for="signup-role" class="text-sand/50 text-xs mb-1 block">${t('role')}</label>
                  <select id="signup-role" class="input-field w-full px-3 py-2.5 rounded-lg text-sm">
                    <option value="player">${t('player')}</option>
                    <option value="field_owner">${t('field_owner')}</option>
                  </select>
                </div>
                <button type="submit" class="btn-primary w-full text-white font-bold py-3 rounded-xl">${t('signup')}</button>
              </form>
              <p class="text-center text-sand/40 text-sm mt-4">${t('or_login')}
                <button onclick="navigate('login')" class="text-pitch hover:underline">${t('login')}</button>
              </p>
            </div>
          </div>
        </div>
      `;
    }

    // PLAYER DASHBOARD
    function renderPlayerDashboard() {
      if (!currentUser || currentUser.role !== 'player') { navigate('login'); return ''; }
      const myBookings = DB.bookings.filter(b => b.userId === currentUser.id);
      return `
        <div class="w-full py-6 px-4">
          <div class="max-w-4xl mx-auto">
            <h1 class="text-2xl font-bold text-white mb-6">👋 ${t('welcome_back')}, ${currentUser.name}</h1>
            <div class="grid grid-cols-2 sm:grid-cols-3 gap-4 mb-8">
              <div class="stat-card rounded-xl p-4 text-center">
                <div class="text-2xl font-bold text-pitch">${myBookings.length}</div>
                <div class="text-sand/40 text-xs">${t('total_bookings')}</div>
              </div>
              <div class="stat-card rounded-xl p-4 text-center">
                <div class="text-2xl font-bold text-pitch">${myBookings.filter(b=>b.status==='confirmed').length}</div>
                <div class="text-sand/40 text-xs">${t('confirmed')}</div>
              </div>
              <div class="stat-card rounded-xl p-4 text-center">
                <div class="text-2xl font-bold text-pitch">${myBookings.reduce((s,b)=>s+b.totalPrice,0).toFixed(0)}</div>
                <div class="text-sand/40 text-xs">${t('aed')} ${t('total')}</div>
              </div>
            </div>
            <h2 class="text-lg font-bold text-white mb-4">${t('my_bookings')}</h2>
            ${myBookings.length === 0
              ? `<div class="glass-card rounded-xl p-8 text-center">
                  <div class="text-3xl mb-2">📅</div>
                  <p class="text-sand/50">${t('no_bookings')}</p>
                  <button onclick="navigate('fields')" class="btn-primary text-white text-sm font-semibold px-4 py-2 rounded-lg mt-4">${t('hero_cta')}</button>
                </div>`
              : `<div class="space-y-3">
                  ${myBookings.map(b => {
                    const field = DB.fields.find(f => f.id === b.fieldId);
                    return `
                      <div class="glass-card rounded-xl p-4 flex items-center justify-between">
                        <div class="flex items-center gap-3">
                          <div class="w-12 h-12 rounded-lg overflow-hidden flex-shrink-0">${generatePitchSVG(field?.id||'x', 48, 48)}</div>
                          <div>
                            <p class="text-white font-semibold text-sm">${field ? field.name : 'Unknown'}</p>
                            <p class="text-sand/40 text-xs">${b.date} • ${b.time} • ${b.duration}${t('minutes')}</p>
                          </div>
                        </div>
                        <div class="text-right">
                          <span class="badge bg-green-500/20 text-green-400 text-xs">${t('confirmed')}</span>
                          <p class="text-pitch font-bold text-sm mt-1">${b.totalPrice.toFixed(0)} ${t('aed')}</p>
                        </div>
                      </div>`;
                  }).join('')}
                </div>`}
          </div>
        </div>
      `;
    }

    // OWNER DASHBOARD
    function renderOwnerDashboard() {
      if (!currentUser || currentUser.role !== 'field_owner') { navigate('login'); return ''; }
      const myFields = DB.fields.filter(f => f.ownerId === currentUser.id);
      const myFieldIds = myFields.map(f => f.id);
      const myBookings = DB.bookings.filter(b => myFieldIds.includes(b.fieldId));
      const totalEarnings = myBookings.reduce((s,b) => s + b.totalPrice * 0.95, 0);
      return `
        <div class="w-full py-6 px-4">
          <div class="max-w-5xl mx-auto">
            <h1 class="text-2xl font-bold text-white mb-6">🏟️ ${t('dashboard')} — ${currentUser.name}</h1>
            <div class="grid grid-cols-2 sm:grid-cols-4 gap-4 mb-8">
              <div class="stat-card rounded-xl p-4 text-center">
                <div class="text-2xl font-bold text-pitch">${myFields.length}</div>
                <div class="text-sand/40 text-xs">${t('my_fields')}</div>
              </div>
              <div class="stat-card rounded-xl p-4 text-center">
                <div class="text-2xl font-bold text-pitch">${myBookings.length}</div>
                <div class="text-sand/40 text-xs">${t('total_bookings')}</div>
              </div>
              <div class="stat-card rounded-xl p-4 text-center">
                <div class="text-2xl font-bold text-pitch">${totalEarnings.toFixed(0)}</div>
                <div class="text-sand/40 text-xs">${t('earnings')} (${t('aed')})</div>
              </div>
              <div class="stat-card rounded-xl p-4 text-center">
                <div class="text-2xl font-bold text-accent">${myFields.filter(f=>!f.approved).length}</div>
                <div class="text-sand/40 text-xs">${t('pending')}</div>
              </div>
            </div>
            <div class="flex gap-4 border-b border-sand/10 mb-6">
              <button class="tab-btn active pb-3 text-sm font-semibold" onclick="showOwnerTab('fields',this)">${t('my_fields')}</button>
              <button class="tab-btn pb-3 text-sm font-semibold text-sand/50" onclick="showOwnerTab('add',this)">${t('add_field')}</button>
            </div>
            <div id="owner-tab-fields">
              ${myFields.length === 0
                ? `<div class="glass-card rounded-xl p-8 text-center"><p class="text-sand/50">${t('no_fields')}</p></div>`
                : `<div class="space-y-3">
                    ${myFields.map(f => `
                      <div class="glass-card rounded-xl p-4 flex items-center justify-between flex-wrap gap-3">
                        <div class="flex items-center gap-3">
                          <div class="w-14 h-10 rounded-lg overflow-hidden flex-shrink-0">${generatePitchSVG(f.id,56,40)}</div>
                          <div>
                            <p class="text-white font-semibold text-sm">${f.name}</p>
                            <p class="text-sand/40 text-xs">${f.area}, ${f.emirate} • ${f.price} ${t('aed')}${t('per_hour')}</p>
                          </div>
                        </div>
                        <div class="flex items-center gap-2">
                          <span class="badge ${f.approved?'bg-green-500/20 text-green-400':'bg-yellow-500/20 text-yellow-400'} text-xs">${f.approved?t('approved'):t('pending')}</span>
                          <span class="badge ${f.active?'bg-blue-500/20 text-blue-400':'bg-red-500/20 text-red-400'} text-xs">${f.active?t('active'):t('inactive')}</span>
                          ${f.approved ? `<button onclick="toggleFieldStatus('${f.id}')" class="text-xs text-sand/40 hover:text-pitch border border-sand/15 px-2 py-1 rounded transition-colors">${t('toggle_status')}</button>` : ''}
                        </div>
                      </div>`).join('')}
                  </div>`}
            </div>
            <div id="owner-tab-add" class="hidden">
              <div class="glass-card rounded-2xl p-6 max-w-lg">
                <h3 class="text-white font-bold text-lg mb-4">➕ ${t('add_field')}</h3>
                <form onsubmit="handleAddField(event)" class="space-y-3">
                  <div>
                    <label for="new-field-name" class="text-sand/50 text-xs mb-1 block">${t('field_name')}</label>
                    <input id="new-field-name" type="text" required class="input-field w-full px-3 py-2 rounded-lg text-sm">
                  </div>
                  <div class="grid grid-cols-2 gap-3">
                    <div>
                      <label for="new-field-emirate" class="text-sand/50 text-xs mb-1 block">${t('emirate')}</label>
                      <select id="new-field-emirate" class="input-field w-full px-3 py-2 rounded-lg text-sm" onchange="updateNewFieldAreas()">
                        ${Object.keys(uaeLocations).map(e => `<option value="${e}">${e}</option>`).join('')}
                      </select>
                    </div>
                    <div>
                      <label for="new-field-area" class="text-sand/50 text-xs mb-1 block">${t('area')}</label>
                      <select id="new-field-area" class="input-field w-full px-3 py-2 rounded-lg text-sm"></select>
                    </div>
                  </div>
                  <div class="grid grid-cols-2 gap-3">
                    <div>
                      <label for="new-field-price" class="text-sand/50 text-xs mb-1 block">${t('price_per_hour')}</label>
                      <input id="new-field-price" type="number" min="50" required class="input-field w-full px-3 py-2 rounded-lg text-sm" value="150">
                    </div>
                    <div>
                      <label for="new-field-size" class="text-sand/50 text-xs mb-1 block">${t('pitch_size')}</label>
                      <select id="new-field-size" class="input-field w-full px-3 py-2 rounded-lg text-sm">
                        <option>5v5</option><option>7v7</option><option>9v9</option><option>11v11</option>
                      </select>
                    </div>
                  </div>
                  <div>
                    <label for="new-field-desc" class="text-sand/50 text-xs mb-1 block">${t('description')}</label>
                    <textarea id="new-field-desc" rows="3" class="input-field w-full px-3 py-2 rounded-lg text-sm"></textarea>
                  </div>
                  <div class="flex items-center gap-3">
                    <label class="flex items-center gap-2 cursor-pointer">
                      <input id="new-field-indoor" type="checkbox" class="accent-pitch w-4 h-4">
                      <span class="text-sand/60 text-sm">${t('indoor')}</span>
                    </label>
                  </div>
                  <button type="submit" class="btn-primary w-full text-white font-bold py-3 rounded-xl">${t('submit_field')}</button>
                </form>
              </div>
            </div>
          </div>
        </div>
      `;
    }

    function initOwnerDashboard() { setTimeout(updateNewFieldAreas, 50); }

    function showOwnerTab(tab, btn) {
      document.querySelectorAll('.tab-btn').forEach(b => { b.classList.remove('active'); b.classList.add('text-sand/50'); });
      btn.classList.add('active'); btn.classList.remove('text-sand/50');
      document.getElementById('owner-tab-fields').classList.toggle('hidden', tab !== 'fields');
      document.getElementById('owner-tab-add').classList.toggle('hidden', tab !== 'add');
      if (tab === 'add') updateNewFieldAreas();
    }

    function updateNewFieldAreas() {
      const emirateSelect = document.getElementById('new-field-emirate');
      const areaSelect = document.getElementById('new-field-area');
      if (!emirateSelect || !areaSelect) return;
      const areas = uaeLocations[emirateSelect.value] || [];
      areaSelect.innerHTML = areas.map(a => `<option value="${a}">${a}</option>`).join('');
    }

    function handleAddField(e) {
      e.preventDefault();
      const name = document.getElementById('new-field-name').value.trim();
      const emirate = document.getElementById('new-field-emirate').value;
      const area = document.getElementById('new-field-area').value;
      const price = Number(document.getElementById('new-field-price').value);
      const pitchSize = document.getElementById('new-field-size').value;
      const description = document.getElementById('new-field-desc').value.trim();
      const indoor = document.getElementById('new-field-indoor').checked;
      if (!name || !price) { showToast('Please fill required fields', 'error'); return; }
      const field = {
        id: genId(), ownerId: currentUser.id, name, emirate, area,
        lat: 25.0, lng: 55.0, indoor, pitchSize, turfType: 'Artificial Turf', price,
        amenities: ['Parking','Water','Floodlights'],
        description: description || 'A great football field.',
        rules: '', approved: false, active: false,
      };
      DB.fields.push(field);
      showToast(t('field_submitted'), 'success');
      renderPage();
    }

    function toggleFieldStatus(fieldId) {
      const field = DB.fields.find(f => f.id === fieldId);
      if (!field) return;
      field.active = !field.active;
      showToast(`Field ${field.active ? 'activated' : 'deactivated'}`, 'info');
      renderPage();
    }

    // ADMIN DASHBOARD
    function renderAdminDashboard() {
      if (!currentUser || currentUser.role !== 'admin') { navigate('login'); return ''; }
      const totalRevenue = DB.payments.reduce((s,p) => s + p.amount, 0);
      const pendingFields = DB.fields.filter(f => !f.approved);
      const pendingOwners = DB.users.filter(u => u.role === 'field_owner' && !u.approved);
      return `
        <div class="w-full py-6 px-4">
          <div class="max-w-6xl mx-auto">
            <h1 class="text-2xl font-bold text-white mb-6">👮 ${t('admin')} ${t('dashboard')}</h1>
            <div class="grid grid-cols-2 sm:grid-cols-4 gap-4 mb-8">
              <div class="stat-card rounded-xl p-4 text-center">
                <div class="text-2xl font-bold text-pitch">${DB.bookings.length}</div>
                <div class="text-sand/40 text-xs">${t('total_bookings')}</div>
              </div>
              <div class="stat-card rounded-xl p-4 text-center">
                <div class="text-2xl font-bold text-pitch">${totalRevenue.toFixed(0)}</div>
                <div class="text-sand/40 text-xs">${t('total_revenue')} (${t('aed')})</div>
              </div>
              <div class="stat-card rounded-xl p-4 text-center">
                <div class="text-2xl font-bold text-pitch">${DB.fields.filter(f=>f.approved).length}</div>
                <div class="text-sand/40 text-xs">${t('active_fields')}</div>
              </div>
              <div class="stat-card rounded-xl p-4 text-center">
                <div class="text-2xl font-bold text-accent">${pendingFields.length + pendingOwners.length}</div>
                <div class="text-sand/40 text-xs">${t('pending_approvals')}</div>
              </div>
            </div>
            <div class="flex gap-4 border-b border-sand/10 mb-6 overflow-x-auto">
              <button class="tab-btn active pb-3 text-sm font-semibold whitespace-nowrap" onclick="showAdminTab('fields',this)">${t('manage_fields')} (${pendingFields.length})</button>
              <button class="tab-btn pb-3 text-sm font-semibold text-sand/50 whitespace-nowrap" onclick="showAdminTab('owners',this)">${t('manage_owners')} (${pendingOwners.length})</button>
              <button class="tab-btn pb-3 text-sm font-semibold text-sand/50 whitespace-nowrap" onclick="showAdminTab('analytics',this)">${t('analytics')}</button>
            </div>
            <div id="admin-tab-fields">
              ${pendingFields.length === 0
                ? `<div class="glass-card rounded-xl p-8 text-center"><p class="text-sand/50">No pending field approvals ✓</p></div>`
                : `<div class="space-y-3">
                    ${pendingFields.map(f => {
                      const owner = DB.users.find(u => u.id === f.ownerId);
                      return `
                        <div class="glass-card rounded-xl p-4">
                          <div class="flex items-center justify-between flex-wrap gap-3">
                            <div class="flex items-center gap-3">
                              <div class="w-16 h-12 rounded-lg overflow-hidden flex-shrink-0">${generatePitchSVG(f.id,64,48)}</div>
                              <div>
                                <p class="text-white font-semibold text-sm">${f.name}</p>
                                <p class="text-sand/40 text-xs">${f.area}, ${f.emirate} • ${f.price} ${t('aed')}${t('per_hour')} • ${f.pitchSize}</p>
                                <p class="text-sand/30 text-xs mt-0.5">Owner: ${owner ? owner.name : 'Unknown'}</p>
                              </div>
                            </div>
                            <div class="flex gap-2">
                              <button onclick="adminApproveField('${f.id}')" class="btn-primary text-white text-xs font-semibold px-4 py-2 rounded-lg">${t('approve')}</button>
                              <button onclick="adminRejectField('${f.id}')" class="border border-red-500/30 text-red-400 text-xs font-semibold px-4 py-2 rounded-lg hover:bg-red-500/10 transition-colors">${t('reject')}</button>
                            </div>
                          </div>
                        </div>`;
                    }).join('')}
                  </div>`}
            </div>
            <div id="admin-tab-owners" class="hidden">
              ${pendingOwners.length === 0
                ? `<div class="glass-card rounded-xl p-8 text-center"><p class="text-sand/50">No pending owner approvals ✓</p></div>`
                : `<div class="space-y-3">
                    ${pendingOwners.map(u => `
                      <div class="glass-card rounded-xl p-4 flex items-center justify-between flex-wrap gap-3">
                        <div>
                          <p class="text-white font-semibold text-sm">${u.name}</p>
                          <p class="text-sand/40 text-xs">${u.email} • ${u.phone}</p>
                        </div>
                        <div class="flex gap-2">
                          <button onclick="adminApproveOwner('${u.id}')" class="btn-primary text-white text-xs font-semibold px-4 py-2 rounded-lg">${t('approve')}</button>
                          <button onclick="adminRejectOwner('${u.id}')" class="border border-red-500/30 text-red-400 text-xs font-semibold px-4 py-2 rounded-lg hover:bg-red-500/10 transition-colors">${t('reject')}</button>
                        </div>
                      </div>`).join('')}
                  </div>`}
            </div>
            <div id="admin-tab-analytics" class="hidden">
              <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                <div class="glass-card rounded-xl p-6">
                  <h3 class="text-white font-bold mb-4">📊 ${t('revenue')} ${t('analytics')}</h3>
                  <div class="space-y-3">
                    <div class="flex justify-between text-sm"><span class="text-sand/50">${t('total_revenue')}</span><span class="text-pitch font-bold">${totalRevenue.toFixed(2)} ${t('aed')}</span></div>
                    <div class="flex justify-between text-sm"><span class="text-sand/50">${t('commission')} (5%)</span><span class="text-accent font-bold">${(totalRevenue*0.05).toFixed(2)} ${t('aed')}</span></div>
                    <div class="flex justify-between text-sm"><span class="text-sand/50">${t('payout')}</span><span class="text-white font-bold">${(totalRevenue*0.95).toFixed(2)} ${t('aed')}</span></div>
                  </div>
                </div>
                <div class="glass-card rounded-xl p-6">
                  <h3 class="text-white font-bold mb-4">📈 Platform Stats</h3>
                  <div class="space-y-3">
                    <div class="flex justify-between text-sm"><span class="text-sand/50">Total Users</span><span class="text-white font-bold">${DB.users.length}</span></div>
                    <div class="flex justify-between text-sm"><span class="text-sand/50">Players</span><span class="text-white font-bold">${DB.users.filter(u=>u.role==='player').length}</span></div>
                    <div class="flex justify-between text-sm"><span class="text-sand/50">Field Owners</span><span class="text-white font-bold">${DB.users.filter(u=>u.role==='field_owner').length}</span></div>
                    <div class="flex justify-between text-sm"><span class="text-sand/50">All Fields</span><span class="text-white font-bold">${DB.fields.length}</span></div>
                    <div class="flex justify-between text-sm"><span class="text-sand/50">Promo Codes</span><span class="text-white font-bold">${DB.promoCodes.length}</span></div>
                  </div>
                </div>
                <div class="glass-card rounded-xl p-6 sm:col-span-2">
                  <h3 class="text-white font-bold mb-4">🗺️ Fields &amp; Bookings by Emirate</h3>
                  <div class="space-y-3">
                    ${Object.keys(uaeLocations).map(em => {
                      const emFields = DB.fields.filter(f => f.emirate === em);
                      const emFieldIds = emFields.map(f => f.id);
                      const emBookings = DB.bookings.filter(b => emFieldIds.includes(b.fieldId)).length;
                      const emFieldCount = emFields.filter(f => f.approved).length;
                      const maxF = Math.max(DB.fields.length, 1);
                      const pct = ((emFieldCount / maxF) * 100).toFixed(0);
                      return `
                        <div>
                          <div class="flex justify-between text-xs mb-1">
                            <span class="text-sand/60">${em}</span>
                            <span class="text-sand/40">${emFieldCount} fields • ${emBookings} bookings</span>
                          </div>
                          <div class="w-full h-2 rounded-full bg-midnightLight overflow-hidden">
                            <div class="h-full rounded-full bg-pitch transition-all" style="width:${pct}%;"></div>
                          </div>
                        </div>`;
                    }).join('')}
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      `;
    }

    function initAdminDashboard() {}

    function showAdminTab(tab, btn) {
      document.querySelectorAll('.tab-btn').forEach(b => { b.classList.remove('active'); b.classList.add('text-sand/50'); });
      btn.classList.add('active'); btn.classList.remove('text-sand/50');
      document.getElementById('admin-tab-fields').classList.toggle('hidden', tab !== 'fields');
      document.getElementById('admin-tab-owners').classList.toggle('hidden', tab !== 'owners');
      document.getElementById('admin-tab-analytics').classList.toggle('hidden', tab !== 'analytics');
    }

    function adminApproveField(fieldId) {
      const field = DB.fields.find(f => f.id === fieldId);
      if (!field) return;
      field.approved = true; field.active = true;
      showToast('Field approved!', 'success'); renderPage();
    }

    function adminRejectField(fieldId) {
      DB.fields = DB.fields.filter(f => f.id !== fieldId);
      showToast('Field rejected', 'info'); renderPage();
    }

    function adminApproveOwner(userId) {
      const user = DB.users.find(u => u.id === userId);
      if (!user) return;
      user.approved = true;
      showToast('Owner approved!', 'success'); renderPage();
    }

    function adminRejectOwner(userId) {
      DB.users = DB.users.filter(u => u.id !== userId);
      showToast('Owner rejected', 'info'); renderPage();
    }

    // INIT
    (function init() {
      changeLanguage(currentLang);
    })();
    </script>
  </body>
</html>
